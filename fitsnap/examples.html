

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7. Examples &mdash; FitSNAP  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/lammps.css?v=d6960128" />

  
    <link rel="shortcut icon" href="_static/fs_favicon.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="1. Contributing" href="contributing.html" />
    <link rel="prev" title="6. ReaxFF Models" href="reaxff.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/FitSNAP.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="run/index.html">3. Run FitSNAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear.html">4. Linear Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="pytorch.html">5. PyTorch Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="reaxff.html">6. ReaxFF Models</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">7. Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fe-linear-npj2021">7.1. Fe_Linear_NPJ2021</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fe-pytorch-nn">7.2. Fe_Pytorch_NN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inp-jpca2020">7.3. InP_JPCA2020</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inp-pace">7.4. InP_PACE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inp-vasp">7.5. InP_VASP</a></li>
<li class="toctree-l2"><a class="reference internal" href="#msd-fe">7.6. MSD-Fe</a></li>
<li class="toctree-l2"><a class="reference internal" href="#n2-reaxff">7.7. N2_ReaxFF</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ta-jax-nn">7.8. Ta_JAX_NN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ta-linear-jcp2014">7.9. Ta_Linear_JCP2014</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ta-pace">7.10. Ta_PACE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ta-pace-ard">7.11. Ta_PACE_ARD</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ta-pace-pytorch-nn">7.12. Ta_PACE_PyTorch_NN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ta-pace-ridge">7.13. Ta_PACE_RIDGE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ta-pytorch-nn">7.14. Ta_PyTorch_NN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ta-quadratic-jcp2018">7.15. Ta_Quadratic_JCP2018</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ta-xyz">7.16. Ta_XYZ</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ta-pytorch-custom-nn">7.17. Ta_pytorch_custom_NN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wbe-prb2019">7.18. WBe_PRB2019</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wbe-pytorch-nn">7.19. WBe_PyTorch_NN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#library">7.20. library</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programmer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">1. Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="executable.html">2. Executable</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib/index.html">3. Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">4. Tests</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FitSNAP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">7. </span>Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="examples">
<h1><span class="section-number">7. </span>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h1>
<section id="fe-linear-npj2021">
<h2><span class="section-number">7.1. </span>Fe_Linear_NPJ2021<a class="headerlink" href="#fe-linear-npj2021" title="Link to this heading"></a></h2>
<p>See <code class="docutils literal notranslate"><span class="pre">examples/Fe_Linear_NPJ2021/</span></code> for details.</p>
</section>
<hr class="docutils" />
<section id="fe-pytorch-nn">
<h2><span class="section-number">7.2. </span>Fe_Pytorch_NN<a class="headerlink" href="#fe-pytorch-nn" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">PyTorch neural network force fitting example.</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>Fit a NN with

    python -m fitsnap3 Fe-example.in --overwrite # use --overwrite to overwrite existing fitsnap files.

The following python scripts help analyze fitting progress and results:

    python plot_error_vs_epochs.py
    python plot_energy_comparison.py
    python plot_force_comparison.py
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="inp-jpca2020">
<h2><span class="section-number">7.3. </span>InP_JPCA2020<a class="headerlink" href="#inp-jpca2020" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">FitSnap3 Indium Phosphide example</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>This example will generate a potential for InP as published in
Cusentino, M.A. et. al, J. Chem. Phys.  (2020).  This version
of the Indium Phosphide potential uses the linear version of SNAP.
This particular example demostrates the Explicit Multi-Element (EME-SNAP)
version of SNAP where the weighted densities are now broken into
partial densities based on atom type leading to a better description
of chemically complex systems.  This option is denoted by &quot;alloyflag&quot;
in the FitSNAP input file.

<span class="gu">#### Running this example:</span>

To run this example, use the following command in this directory:

mpirun -n 4 python3 -m fitsnap3 InP-example.in

<span class="gu">#### Files in this Directory</span>

InP-example.in

Input file containing parameters to run FitSNAP and generate
the Indium Phosphide potential

JSON/

Directory that contains all the training configurations which are organized
into different groups.

<span class="gu">#### Files generated by example:</span>

InP_pot.snapcoeff

SNAP potential coefficient file that contains all the beta coefficients for
this potential.  This is one of two files needed to use this potential in LAMMPS

InP_pot.snapparam

SNAP potential parameters file that contains the hyperparameters and options used during
the fit for this potential.  This is one of two files needed to use this potential in LAMMPS

InP_metrics.csv

Contains a variety of error metrics for all the training groups for this fit.

Note that the 20May21_Standard/ directory contains sample output for this example


<span class="gu">#### Important input parameters for this example</span>

rcutfac = 1  : Radial cutoff (hyperparameter) chosen for this potential

wj1 = 1.0 : Elemental weight on Indium for density expansion

wj2 = 9.293160905266721e-01 : : Elemental weight on Phosphide for density expansion

radelem1 = 3.812045629514403e : Indium per-element cutoff

radelem2 = 3.829453817954964e : Phospide per-element cutoff

type1 = In : Chemical symbol for element which should match training files in JSON

type2 = P  : Chemical symbol for element which should match training files in JSON

eshift = In : -1.65967588701534  : Per atom training data energy shift for In

eshift = P  : 4.38159549501534 : Per atom training data energy shift for P

quadraticflag = 0 : Quadratic SNAP is turned off, using linear SNAP

chemflag = 1 : Flag to turn on EME-SNAP

bnormflag = 1 : Flag to turn on normalization of j indices (speeds up MD runs)

wselfallflag = 1 : Adds wself contribution to the density


See docs/TEMPLATE.in for further information on input parameters

<span class="gu">#### Indium Phosphide data from:</span>

The JSON configurations and hyperparameters used for this example are published in:

<span class="k">-</span><span class="w"> </span>Thompson, A.P., et. al.,, Automated algorithms for quantum-level accuracy in
  atomistic simulations: LDRD final report, Technical Report SAND 2014-17862, Sandia
  National Laboratories, Albuquerque, NM, 2014.

<span class="k">-</span><span class="w"> </span>Cusentino, M.A., Wood, M.A., and Thompson, A.P., Explicit Multi-element Extension of
  the Spectral Neighbor Analysis Potential for Chemically Complex Systems, J. Chem.
  Phys. (2020).

<span class="gs">**Note to Developers: Make sure this example still reproduces the same results when modifying code**</span>
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="inp-pace">
<h2><span class="section-number">7.4. </span>InP_PACE<a class="headerlink" href="#inp-pace" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">FitSnap3 Indium Phosphide example with ACE</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span><span class="gu">## Important Notes</span>
Multi-element ACE fit with reference energies (bzeroflag=1).
The &#39;erefs&#39; variable in the ACE section may be used to set
the intercept manually in the .yace potential file, but by
default, the intercept for bzeroflag=1 should be 0.0 for all
elements.

<span class="gu">### Energy and forces only</span>
Input file and expected output in 30Mar23_Standard.
Example of multielement ACE fit from FitSNAP. This example
requires that sklearn is installed for the ARD solver. The
priors are chosen based on variance in the (weighted)
training energies and forces. The default example in the
top directory is this fit.

<span class="gu">### With stresses</span>
Input file and expected output in 30Mar23_Standard_Stress.
Example of multielement ACE fit from FitSNAP. This example
requires that sklearn is installed for the ARD solver. The
priors are chosen based on variance in the (weighted)
training energies, forces, and stresses.
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="inp-vasp">
<h2><span class="section-number">7.5. </span>InP_VASP<a class="headerlink" href="#inp-vasp" title="Link to this heading"></a></h2>
<p>See <code class="docutils literal notranslate"><span class="pre">examples/InP_VASP/</span></code> for details.</p>
</section>
<hr class="docutils" />
<section id="msd-fe">
<h2><span class="section-number">7.6. </span>MSD-Fe<a class="headerlink" href="#msd-fe" title="Link to this heading"></a></h2>
<p>See <code class="docutils literal notranslate"><span class="pre">examples/MSD-Fe/</span></code> for details.</p>
</section>
<hr class="docutils" />
<section id="n2-reaxff">
<h2><span class="section-number">7.7. </span>N2_ReaxFF<a class="headerlink" href="#n2-reaxff" title="Link to this heading"></a></h2>
<p>See <code class="docutils literal notranslate"><span class="pre">examples/N2_ReaxFF/</span></code> for details.</p>
</section>
<hr class="docutils" />
<section id="ta-jax-nn">
<h2><span class="section-number">7.8. </span>Ta_JAX_NN<a class="headerlink" href="#ta-jax-nn" title="Link to this heading"></a></h2>
<p>See <code class="docutils literal notranslate"><span class="pre">examples/Ta_JAX_NN/</span></code> for details.</p>
</section>
<hr class="docutils" />
<section id="ta-linear-jcp2014">
<h2><span class="section-number">7.9. </span>Ta_Linear_JCP2014<a class="headerlink" href="#ta-linear-jcp2014" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">FitSnap3 Tantalum example</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>This example will generate a potential for tantalum as published in
Thompson, A.P. et. al, J. Comp. Phys. 285 (2015) 316-330.  This version
of the tantalum potential uses the linear version of SNAP.

<span class="gu">#### Running this example:</span>

To run this example, use the following command in this directory:

    python -m fitsnap3 Ta-example.in

<span class="gu">#### Files in this Directory</span>

<span class="sb">`Ta-example.in`</span>

Input file containing parameters to run FitSNAP and generate
the tantalum potential

<span class="sb">`JSON/`</span>

Directory that contains all the training configurations which are organized
into different groups.

<span class="gu">#### Files generated by example:</span>

<span class="sb">`Ta_pot.snapcoeff`</span>

SNAP potential coefficient file that contains all the beta coefficients for
this potential.  This is one of two files needed to use this potential in LAMMPS

<span class="sb">`Ta_pot.snapparam`</span>

SNAP potential parameters file that contains the hyperparameters and options used during
the fit for this potential.  This is one of two files needed to use this potential in LAMMPS

<span class="sb">`Ta_metrics.md`</span>

Contains a variety of error metrics for all the training groups for this fit.

Note that the <span class="sb">`20May21_Standard/`</span> directory contains sample output for this example

<span class="sb">`FitSNAP.df`</span>

Pickled pandas dataframe whose columns contain various quantities associated with the fit. For those unfamiliar with pandas dataframes, this file can be loaded in python with:

        import pandas as pd
        data = pd.read_pickle(&quot;FitSNAP.df&quot;)

and we can extract data using typical pandas dataframe attributes, for example:

        print(data.columns) # see which columns we have
        print(data[&quot;Row_Type&quot;].values) # print the values of row types in the A matrix

<span class="gu">#### Important input parameters for this example</span>

rcutfac = 4.67637  : Radial cutoff (hyperparameters) chosen for this potential
wj1 = 1.0 : Elemental weight on tantalum for density expansion
radelem1 = 0.5 : Tantalum per-element cutoff
type1 = Ta : Chemical symbol for element which should match training files in JSON
quadraticflag = 0 : Quadratic SNAP is turned off, using linear SNAP

See docs/TEMPLATE.in for further information on input parameters

<span class="gu">#### Tantalum data from:</span>

The JSON configurations and hyperparameters used for this example are published in:

Thompson, A. P., Swiler, L. P., Trott, C. R., Foiles, S. M., &amp; Tucker, G. J. (2015).
Spectral neighbor analysis method for automated generation of quantum-accurate interatomic
potentials. Journal of Computational Physics, 285, 316-330

<span class="gs">**Note to Developers: Make sure this example still reproduces the same results when modifying code**</span>

After running the example, use <span class="sb">`python compare_snapcoeff.py`</span> to calculate the max absolute difference in SNAP coefficients from the standard.
The values should agree within a near zero amount (machine precision or close).
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="ta-pace">
<h2><span class="section-number">7.10. </span>Ta_PACE<a class="headerlink" href="#ta-pace" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">FitSnap3 Ta example with ACE</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span><span class="gu">## Important Note</span>
As with other ACE fits, regularization is highly
recommended. Please see Ta_PACE_Ridge and the TA_PACE_ARD
examples for practical use cases. This is an example using
SVD to obtain ACE coefficients, with group weights from
an optimized SNAP potential of Ta.
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="ta-pace-ard">
<h2><span class="section-number">7.11. </span>Ta_PACE_ARD<a class="headerlink" href="#ta-pace-ard" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">FitSnap3 Ta example with ACE</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span><span class="gu">## Important Note</span>
As with other ACE fits, regularization is highly
recommended. These Ta potentials are minimally tested and
are here for demonstration purposes. This example uses ARD
a.k.a relevance vector learning to both apply
regularization as well as obtain a sparse solution to the
linear ACE model.

<span class="gu">### ARD regression for sparse linear ACE</span>
ARD is the recommended regressor for linear ACE models.
The use of this method requires the installation of
sklearn, which can be easily installed with python pip.
In the 29Mar23_ARD example directory, the input for an ARD
fit may be found. This method assumes an elliptical
gaussian prior for all of the ACE weights. This prior is
adaptively scaled to the variance of the &lt;i&gt;weighted&lt;/i&gt;
training data set. This allows for sparse solutions to
the ACE weights, and for the use of fewer descriptors in a
potential. &lt;b&gt;This example requires the installation of
external libraries (sklearn).&lt;/b&gt; More info about
this method can be found in the documentation for sklearn
&lt;a&gt;https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ARDRegression.html&lt;/a&gt;.


<span class="gu">### ARD Hyperparameters</span>

directmethod : (bool) flag to use the hyperparameter scheme
from sklearn, without using training data to help choose
the hyperparameters (default is off)
&lt;br&gt;
&lt;b&gt; Hyperparameters if &lt;u&gt;not&lt;/u&gt; using the directmethod &lt;/b&gt;
&lt;br&gt;
scap : (float) scaling factor for the prior distribution
of the linear model coefficients (to be rescaled based on
training data variance)
&lt;br&gt;
scai : (float) scaling factor for the prior distribution
of the uncertainty of the linear model coefficients. (to be
rescaled based on training data variance) Simultaneously
increasing or decreasing scap and scai will change the
absolute scale of model coefficients.
&lt;br&gt;
logcut : (float) log&lt;sub&gt;10&lt;/sub&gt; value of the cutoff
threshhold for pruning descriptors. Increasing this value
will add descriptors into the model, lowest uncertainty
first. Decreasing this value will prune descriptors from
the model, highest uncertainty first.
&lt;br&gt;
&lt;b&gt; Hyperparameters if using the directmethod &lt;/b&gt;
&lt;br&gt;
alpha_big : (float) primary parameter for a gamma dist.
prior for the linear model coefficients
&lt;br&gt;
alpha_small : (float) secondary parameter for the gamma
distribution for the linear model coefficients
&lt;br&gt;
lambda_big : (float) primary parameter for a gamma dist.
prior for the uncertainties of the linear model
coefficients.
&lt;br&gt;
lambda_small : (float) secondary parameter for the gamma
distribution for the uncertainties of the linear model
coefficients.
&lt;br&gt;
threshold_lambda : (int) threshold for pruning descriptors/
(via setting the linear model coefficients to 0)
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="ta-pace-pytorch-nn">
<h2><span class="section-number">7.12. </span>Ta_PACE_PyTorch_NN<a class="headerlink" href="#ta-pace-pytorch-nn" title="Link to this heading"></a></h2>
<p>See <code class="docutils literal notranslate"><span class="pre">examples/Ta_PACE_PyTorch_NN/</span></code> for details.</p>
</section>
<hr class="docutils" />
<section id="ta-pace-ridge">
<h2><span class="section-number">7.13. </span>Ta_PACE_RIDGE<a class="headerlink" href="#ta-pace-ridge" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">FitSnap3 Ta example with ACE</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span><span class="gu">## Important Note</span>
As with other ACE fits, regularization is highly
recommended. These Ta potentials are minimally tested and
are here for demonstration purposes. This example uses
the RIDGE regression technique to apply a penalty to ACE
coefficients that are too large via the L2 norm penalty.


<span class="gu">### RIDGE regression</span>
This is the default example provided for the linear ACE fit
of Ta. The ridge regressor may be used from sklearn, or
through internal solvers. No additional installation of
sklearn is required for this example. The default input in
this top directory, and in 30Mar23_RIDGE, uses a ridge
regressor from FitSNAP by default. Otherwise, this is a
copy of the ARD example but with a different regressor.

RIDGE regression is one of the more simple ways to obtain
a regularized solution to the least squares problem. An L2
penalty ( &lt;b&gt;w&lt;/b&gt; &lt;sup&gt;T&lt;/sup&gt; (α &lt;b&gt;I&lt;/b&gt;) &lt;b&gt;w&lt;/b&gt; ) is added
to the least squares cost function to penalize model
weights that get too large. While this can reduce
overfitting and stabilize models, it does little for
sparsification/feature selection.

<span class="gu">### RIDGE hyperparameters</span>

alpha : (float) regularization hyperparameter that scales
the penalty for the linear model coefficients. Increasing
this value will result in models with linear model
coefficients with lower absolute values.

local_solver : (bool) flag to use the RIDGE regressor from
the FitSNAP library (default) or to use the sklearn RIDGE
regressor
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="ta-pytorch-nn">
<h2><span class="section-number">7.14. </span>Ta_PyTorch_NN<a class="headerlink" href="#ta-pytorch-nn" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">PyTorch neural network force fitting example.</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>Fit a NN with

    python -m fitsnap3 Ta-example.in --overwrite # use --overwrite if you want to overwrite existing
fitsnap files.

This also creates corresponding plots of errors vs. epochs and target force vs. model force.

To check that the model forces match those calculated with finite difference, do
<span class="sb">`python fd_force_check.py`</span>, which creates a <span class="sb">`fd_force_check.png`</span> plot.
This finite difference script uses the same force calculation routine that we use in
<span class="sb">`fitsnap3lib/lib/neural_networks/pytorch.py`</span>

When fitting forces AND energies, it was found to best have <span class="sb">`energy_weight=1e-2`</span> and
<span class="sb">`force_weight=1.0`</span> or some similar ratio.

<span class="gu">### Calculating fitting errors.</span>

FitSNAP produces output files that we can use to calculate error ourselves. To do this, run

    python plot_comparison.py

which will calculate errors and plot comparisons with the detailed fitting data.

<span class="gu">### Running MD with NN potential.</span>

Refer to folder &quot;MD&quot; for instructions to run MD simulations with the potential.

<span class="gu">### Evaluating energies/forces in Python.</span>

Sometimes you want to calculate energies/forces on another set using an already fitted model. In this
case it is wasteful to re-calculate the descriptors. We can therefore load a pickled list of
Configuration objects which are used by FitSNAP for NN fitting. First generate the pickled list
of Configuration objects <span class="sb">`configs.pickle`</span> by performing a fit, then use the script
<span class="sb">`evaluate_configs.py`</span> which will load this pickled list and calculate energies/forces for all
configs.
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="ta-quadratic-jcp2018">
<h2><span class="section-number">7.15. </span>Ta_Quadratic_JCP2018<a class="headerlink" href="#ta-quadratic-jcp2018" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">FitSnap3 Tantalum quadratic example</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>This example will generate a potential for tantalum as published in
Wood, M. A., &amp; Thompson, A. P. (2018) J. Chem. Phys. 24 (2018) 241721.  This version
of the tantalum potential uses the quadratic version of SNAP.

<span class="gu">#### Running this example:</span>

To run this example, use the following command in this directory:

mpirun -n 4 python3 -m fitsnap3 Ta-example.in

<span class="gu">#### Files in this Directory</span>

Ta-example.in

Input file containing parameters to run FitSNAP and generate
the tantalum quadratic potential

JSON/

Directory that contains all the training configurations which are organized
into different groups.

<span class="gu">#### Files generated by example:</span>

Ta_pot.snapcoeff

SNAP potential coefficient file that contains all the beta coefficients for
this potential.  This is one of two files needed to use this potential in LAMMPS

Ta_pot.snapparam

SNAP potential parameters file that contains the hyperparameters and options used during
the fit for this potential.  This is one of two files needed to use this potential in LAMMPS

Ta_metrics.csv

Contains a variety of error metrics for all the training groups for this fit.

Note that the 20May21_Standard/ directory contains sample output for this example for comparison

<span class="gu">#### Important input parameters for this example</span>

rcutfac = 5.594 : Radial cutoff (hyperparameters) chosen for this potential (different from linear example)
wj1 = 1.0 : Elemental weight on tantalum for density expansion
radelem1 = 0.5 : Tantalum per-element cutoff
type1 = Ta : Chemical symbol for element which should match training files in JSON
bzeroflag = 1 : Forces Bspec to 0 when atoms are non-interacting (different from linear example)
quadraticflag = 1 : Quadratic SNAP is turned on, using quadratic SNAP (different from linear example)

See docs/TEMPLATE.in for further information on input parameters

<span class="gu">#### Tantalum data from:</span>

The JSON configurations and hyperparameters used for this example are published in:

Wood, M. A., &amp; Thompson, A. P. (2018). Extending the accuracy of
the SNAP interatomic potential form. The Journal of chemical
physics, 148(24), 241721.


<span class="gs">**Note to Developers: Make sure this example still reproduces the same results when modifying code**</span>
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="ta-xyz">
<h2><span class="section-number">7.16. </span>Ta_XYZ<a class="headerlink" href="#ta-xyz" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">FitSnap3 Tantalum example</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>This example will generate a potential for tantalum as published in
Thompson, A.P. et. al, J. Comp. Phys. 285 (2015) 316-330.  This version
of the tantalum potential uses the linear version of SNAP.

<span class="gu">#### Running this example:</span>

To run this example, use the following command in this directory:

python3 -m fitsnap3 Ta-example.in

<span class="gu">#### Files in this Directory</span>

Ta-example.in

Input file containing parameters to run FitSNAP and generate
the tantalum potential

grouplist.in

File that lists all the training groups in the JSON directory,
the number of files in each group, and the energy, force, and virial training
weights on each group.

XYZ/

Directory that contains all the training configurations which are organized
into different groups.

<span class="gu">#### Files generated by example:</span>

Ta_pot.snapcoeff

SNAP potential coefficient file that contains all the beta coefficients for
this potential.  This is one of two files needed to use this potential in LAMMPS

Ta_pot.snapparam

SNAP potential parameters file that contains the hyperparameters and options used during
the fit for this potential.  This is one of two files needed to use this potential in LAMMPS

Ta_metrics.csv

Contains a variety of error metrics for all the training groups for this fit.

Note that the 19Nov19_Standard/ directory contains sample output for this example


<span class="gu">#### Important input parameters for this example</span>

rcutfac = 4.67637  : Radial cutoff (hyperparameters) chosen for this potential
wj1 = 1.0 : Elemental weight on tantalum for density expansion
radelem1 = 0.5 : Tantalum per-element cutoff
type1 = Ta : Chemical symbol for element which should match training files in JSON
quadraticflag = 0 : Quadratic SNAP is turned off, using linear SNAP

See docs/TEMPLATE.in for further information on input parameters

<span class="gu">#### Tantalum data from:</span>

The XYZ configurations and hyperparameters used for this example are published in:

Thompson, A. P., Swiler, L. P., Trott, C. R., Foiles, S. M., &amp; Tucker, G. J. (2015).
Spectral neighbor analysis method for automated generation of quantum-accurate interatomic
potentials. Journal of Computational Physics, 285, 316-330

<span class="gs">**Note to Developers: Make sure this example still reproduces the same results when modifying code**</span>
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="ta-pytorch-custom-nn">
<h2><span class="section-number">7.17. </span>Ta_pytorch_custom_NN<a class="headerlink" href="#ta-pytorch-custom-nn" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">PyTorch neural network force fitting example.</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>Fit a NN with

    # use --overwrite if you want to overwrite existing fitsnap files

    python -m fitsnap3 Ta-example.in --overwrite

This also creates corresponding plots of errors vs. epochs and target force vs. model force.

To check that the model forces match those calculated with finite difference, do
<span class="sb">`python fd_force_check.py`</span>, which creates a <span class="sb">`fd_force_check.png`</span> plot.
This finite difference script uses the same force calculation routine that we use in
<span class="sb">`fitsnap3lib/lib/neural_networks/pytorch.py`</span>

When fitting forces AND energies, it was found to best have <span class="sb">`energy_weight=1e-2`</span> and
<span class="sb">`force_weight=1.0`</span> or some similar ratio.

<span class="gu">### Calculating fitting errors.</span>

FitSNAP produces output files that we can use to calculate error ourselves. To do this, run

    python calculate_fitting_errors.py

which will calculate mean absolute errors for energy and forces, as well as plot a distribution of
force errors, for the training and validation sets.

<span class="gu">### Running MD with NN potential.</span>

Refer to folder &quot;MD&quot; for instructions to run MD simulations with the potential.
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="wbe-prb2019">
<h2><span class="section-number">7.18. </span>WBe_PRB2019<a class="headerlink" href="#wbe-prb2019" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">FitSnap3 Tungten - Beryllium example</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>This example will generate a potential for tungsten and beryllium as published in
Wood, M. A., et. al. Phys. Rev. B 99 (2019) 184305.  This potential was developed
for the purpose of studying plasma material interactions in fusion reactors.

<span class="gu">#### Running this example:</span>

To run this example, use the following command in this directory:

mpirun -n 4 python3 -m fitsnap3 WBe-example.in

<span class="gu">#### Files in this Directory</span>

WBe-example.in

Input file containing parameters to run FitSNAP and generate
the W-Be potential

JSON/

Directory that contains all the training configurations which are organized
into different groups.

<span class="gu">#### Files generated by example:</span>

WBe_pot.snapcoeff

SNAP potential coefficient file that contains all the beta coefficients for
this potential.  This is one of two files needed to use this potential in LAMMPS

WBe_pot.snapparam

SNAP potential parameters file that contains the hyperparameters and options used during
the fit for this potential.  This is one of two files needed to use this potential in LAMMPS

WBe_metrics.csv

Contains a variety of error metrics for all the training groups for this fit.

Note that the 20May21_Standard/ directory contains sample output for this example for comparison

<span class="gu">#### Important input parameters for this example</span>

numTypes = 2 : Two atom types for this example
rcutfac = 4.812302818 : Radial cutoff (hyperparameter) chosen for this potential
wj1 = 1.0 : Elemental weight on tungsten for density expansion
wj2 = 0.9590493408 : Elemental weight on beryllium for density expansion
radelem1 = 0.5 : Tungsten per-element cutoff
radelem2 = 0.417932464 : Beryllium per-element cutoff
type1 = W : Chemical symbol for first element which should match training files in JSON
type2 = Be : Chemical symbol for second element which should match training files in JSON
bzeroflag = 1 : Forces Bspec to 0 when atoms are non-interacting (different from linear example)
quadraticflag = 0 : Quadratic SNAP is turned off, using linear SNAP

See docs/TEMPLATE.in for further information on input parameters

<span class="gu">#### Tungsten-Beryllium data from:</span>

The JSON configurations and hyperparameters used for this example are published in:

Wood, Mitchell A., et al. &quot;Data-driven material models for
atomistic simulation.&quot; Physical Review B 99.18 (2019): 184305.

<span class="gs">**Note to Developers: Make sure this example still reproduces the same results when modifying code**</span>
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="wbe-pytorch-nn">
<h2><span class="section-number">7.19. </span>WBe_PyTorch_NN<a class="headerlink" href="#wbe-pytorch-nn" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">FitSnap3 NN Tungten - Beryllium example</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>This example will generate a NN potential for WBe using the <span class="sb">`WBe_PRB2019`</span> dataset.

<span class="gu">#### Running this example:</span>

To run this example, use the following command in this directory:

python3 -m fitsnap3 WBe-example.in --overwrite # use --overwrite if you already have fitsnap files
saved.

<span class="gu">#### Files in this Directory</span>

WBe-example.in

Input file containing parameters to run FitSNAP and generate a SNAP-NN potential

MD/

Directory that contains an example with running MD in LAMMPS using the PyTorch model from FitSNAP.
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="library">
<h2><span class="section-number">7.20. </span>library<a class="headerlink" href="#library" title="Link to this heading"></a></h2>
<div class="hint admonition">
<p class="admonition-title">Examples using FitSNAP library</p>
<div class="highlight-md notranslate"><div class="highlight"><pre><span></span>This directory houses Python scripts that do various things with the fitsnap library.
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="reaxff.html" class="btn btn-neutral float-left" title="6. ReaxFF Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="contributing.html" class="btn btn-neutral float-right" title="1. Contributing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2025, Sandia Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
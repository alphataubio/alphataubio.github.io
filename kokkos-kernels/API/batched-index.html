<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="dense" href="batched/dense-index.html" /><link rel="prev" title="KokkosBlas::trsm" href="blas/blas3_trsm.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.04.27 -->
        <title>API: Batched - Kokkos Kernels documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=437aa6ec" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=949a1ff5" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/hacks.css?v=76c1c40f" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Kokkos Kernels  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Kokkos Kernels  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building.html">Building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cmake-keywords.html">CMake Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-index.html">API: Common</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="blas-index.html">API: BLAS</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API: BLAS</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="blas/blas1_abs.html">KokkosBlas::abs</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas1_axpy.html">KokkosBlas::axpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas1_dot.html">KokkosBlas::dot</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas1_iamax.html">KokkosBlas::iamax</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas1_nrm1.html">KokkosBlas::nrm1</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas1_nrm2.html">KokkosBlas::nrm2</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas1_rotg.html">KokkosBlas::rotg</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas1_rot.html">KokkosBlas::rot</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas1_rotmg.html">KokkosBlas::rotmg</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas1_rotm.html">KokkosBlas::rotm</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas1_scal.html">KokkosBlas::scal</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas1_swap.html">KokkosBlas::swap</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas2_gemv.html">KokkosBlas::gemv</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas2_ger.html">KokkosBlas::ger</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas2_syr.html">KokkosBlas::syr</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas2_syr2.html">KokkosBlas::syr2</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas3_gemm.html">KokkosBlas::gemm</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas3_trmm.html">KokkosBlas::trmm</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas/blas3_trsm.html">KokkosBlas::trsm</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children current-page"><a class="current reference internal" href="#">API: Batched</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of API: Batched</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="batched/dense-index.html">dense</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of dense</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_AddRadial.html">KokkosBatched::AddRadial</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_ApplyHouseholder.html">KokkosBatched::ApplyHouseholder</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_ApplyPivot.html">KokkosBatched::ApplyPivot</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_ApplyQ.html">KokkosBatched::ApplyQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Axpy.html">KokkosBatched::Axpy</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Copy.html">KokkosBatched::Copy</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Dot.html">KokkosBatched::Dot</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Eigendecomposition.html">KokkosBatched::Eigendecomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Gbtrf.html">KokkosBatched::Gbtrf</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Gbtrs.html">KokkosBatched::Gbtrs</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Gemm.html">KokkosBatched::Gemm</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Gemv.html">KokkosBatched::Gemv</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Ger.html">KokkosBatched::Ger</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Gesv.html">KokkosBatched::Gesv</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Getrf.html">KokkosBatched::Getrf</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Getrs.html">KokkosBatched::Getrs</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_HadamardProduct.html">KokkosBatched::HadamardProduct</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Householder.html">KokkosBatched::Householder</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Iamax.html">KokkosBatched::Iamax</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_InverseLU.html">KokkosBatched::InverseLU</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_LU.html">KokkosBatched::LU</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Lacgv.html">KokkosBatched::Lacgv</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Laswp.html">KokkosBatched::Laswp</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Pbtrf.html">KokkosBatched::Pbtrf</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Pbtrs.html">KokkosBatched::Pbtrs</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Pttrf.html">KokkosBatched::Pttrf</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Pttrs.html">KokkosBatched::Pttrs</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_QR.html">KokkosBatched::QR</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_SVD.html">KokkosBatched::SVD</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_SetIdentity.html">KokkosBatched::SetIdentity</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_SolveLU.html">KokkosBatched::SolveLU</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_SolveUTV.html">KokkosBatched::SolveUTV</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Syr.html">KokkosBatched::Syr</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Trmm.html">KokkosBatched::Trmm</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Trsm.html">KokkosBatched::Trsm</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Trsv.html">KokkosBatched::Trsv</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Trtri.html">KokkosBatched::Trtri</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_UTV.html">KokkosBatched::UTV</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Vector.html">KokkosBatched::Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/dense/KokkosBatched_Xpay.html">KokkosBatched::Xpay</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="batched/sparse-index.html">sparse</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of sparse</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="batched/sparse/KokkosBatched_CG.html">KokkosBatched::CG</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/sparse/KokkosBatched_CrsMatrix.html">KokkosBatched::CrsMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/sparse/KokkosBatched_GMRES.html">KokkosBatched::GMRES</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/sparse/KokkosBatched_Identity.html">KokkosBatched::Identity</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/sparse/KokkosBatched_JacobiPrec.html">KokkosBatched::JacobiPrec</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/sparse/KokkosBatched_Krylov_Handle.html">KokkosBatched::KrylovHandle</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/sparse/KokkosBatched_Krylov_Solvers.html">KokkosBatched::Krylov_Solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="batched/sparse/KokkosBatched_Spmv.html">KokkosBatched::Spmv</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lapack-index.html">API: LAPACK</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of API: LAPACK</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="lapack/gesv.html">KokkosLapack::gesv</a></li>
<li class="toctree-l2"><a class="reference internal" href="lapack/gesvd.html">KokkosLapack::svd</a></li>
<li class="toctree-l2"><a class="reference internal" href="lapack/trtri.html">KokkosLapack::trtri</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sparse-index.html">API: Sparse</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of API: Sparse</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="sparse/bsr_matrix.html">KokkosSparse::BsrMatrix</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of KokkosSparse::BsrMatrix</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="sparse/BsrMatrix_constructors.html">KokkosSparse::BsrMatrix&lt;&gt;::BsrMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="sparse/bsr_row_view.html">KokkosSparse::BsrRowView</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="sparse/crs_matrix.html">KokkosSparse::CrsMatrix</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of KokkosSparse::CrsMatrix</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="sparse/CrsMatrix_constructors.html">KokkosSparse::CrsMatrix&lt;&gt;::CrsMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="sparse/sparse_row_view.html">KokkosSparse::SparseRowView</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="sparse/kokkoskernelshandle.html">KokkosKernels::Experimental::KokkosKernelsHandle</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of KokkosKernels::Experimental::KokkosKernelsHandle</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="sparse/handle_get_create_destroy.html">KokkosKernels::Experimental::KokkosKernelsHandle::{get,create,destroy}</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sparse/spmv.html">KokkosSparse::spmv</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/spadd_symbolic.html">KokkosSparse::spadd_symbolic</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/spadd_numeric.html">KokkosSparse::spadd_numeric</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/spgemm_symbolic.html">KokkosSparse::spgemm_symbolic</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/spgemm_numeric.html">KokkosSparse::spgemm_numeric</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/sptrsv_symbolic.html">KokkosSparse::sptrsv_symbolic</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/sptrsv_solve.html">KokkosSparse::sptrsv_solve</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/gauss_seidel_symbolic.html">KokkosSparse::gauss_seidel_symbolic</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/gauss_seidel_numeric.html">KokkosSparse::gauss_seidel_numeric</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/gauss_seidel_apply_symmetric.html">KokkosSparse::symmetric_gauss_seidel_apply</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/gauss_seidel_apply_forward.html">KokkosSparse::forward_sweep_gauss_seidel_apply</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/gauss_seidel_apply_backward.html">KokkosSparse::backward_sweep_gauss_seidel_apply</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/spiluk_symbolic.html">KokkosSparse::spiluk_symbolic</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/spiluk_numeric.html">KokkosSparse::spiluk_numeric</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/par_ilut.html">KokkosSparse::par_ilut_symbolic</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/par_ilut.html#kokkossparse-par-ilut-numeric">KokkosSparse::par_ilut_numeric</a></li>
<li class="toctree-l2"><a class="reference internal" href="sparse/par_ilut.html#kokkossparse-par-iluthandle">KokkosSparse::PAR_ILUTHandle</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="graph-index.html">API: Graph</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of API: Graph</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="graph/distance1_color.html">KokkosGraph::graph_color_symbolic</a></li>
<li class="toctree-l2"><a class="reference internal" href="graph/distance2_color.html">KokkosGraph::graph_color_distance2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../known_issues.html">Known issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deprecation_page.html">Deprecations</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/kokkos/kokkos-tutorials">Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/kokkos/kokkos-kernels">GitHub Repo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
<div class="edit-this-page">
  <a class="muted-link" href="https://github.com/kokkos/kokkos-core-wiki/blob/main/docs/source/API/batched-index.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4"></path>
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5"></line>
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div>

          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="api-batched">
<h1>API: Batched<a class="headerlink" href="#api-batched" title="Link to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>KokkosBatched is a high-performance, portable library for batched linear algebra operations on manycore architectures. It addresses a critical performance gap in scientific computing: the ability to solve many small-to-medium sized linear algebra problems simultaneously. This computational pattern arises in numerous applications, including finite element analysis, computational fluid dynamics, quantum chemistry, machine learning, and uncertainty quantification.</p>
<p>The central premise of KokkosBatched is that for many small problems, traditional linear algebra approaches that process one problem at a time are suboptimal on modern hardware. By processing multiple independent problems simultaneously, KokkosBatched achieves:</p>
<ol class="arabic simple">
<li><p>Higher arithmetic intensity and improved data locality</p></li>
<li><p>Better utilization of vector / SIMD units</p></li>
<li><p>Reduced kernel launch overhead</p></li>
<li><p>Increased parallelism at multiple levels</p></li>
</ol>
<p>The library is built on Kokkos Core, providing portability across diverse architectures including multicore CPUs, NVIDIA and AMD GPUs, and Intel XPUs, without requiring architecture-specific code rewrites.</p>
</section>
<section id="mathematical-foundation">
<h2>Mathematical Foundation<a class="headerlink" href="#mathematical-foundation" title="Link to this heading">¶</a></h2>
<section id="batched-representation">
<h3>Batched Representation<a class="headerlink" href="#batched-representation" title="Link to this heading">¶</a></h3>
<p>At a fundamental level, the batched paradigm involves operating on tensor expressions where one dimension represents the batch index. For instance, the mathematical formulation of batched matrix-matrix multiplication is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[C_{b,i,j} = \sum_{k=0}^{n-1} A_{b,i,k} \cdot B_{b,k,j} \quad \forall b \in [0, \text{batch\_size} - 1]\]</div>
</div>
<p>Where <span class="math notranslate nohighlight">\(b\)</span> represents the batch index, and the computation for each batch element is independent of others.</p>
<p>For sparse matrices, the representation becomes more nuanced. KokkosBatched offers an efficient approach where matrices with identical sparsity patterns (but different values) are stored together:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}A_b = \begin{pmatrix}
a_{b,1,1} &amp; a_{b,1,2} &amp; \cdots &amp; a_{b,1,n} \\
a_{b,2,1} &amp; a_{b,2,2} &amp; \cdots &amp; a_{b,2,n} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
a_{b,m,1} &amp; a_{b,m,2} &amp; \cdots &amp; a_{b,m,n}
\end{pmatrix}\end{split}\]</div>
</div>
<p>The library utilizes specialized data structures that minimize memory footprint while maximizing computational efficiency.</p>
</section>
<section id="hierarchical-parallelism">
<h3>Hierarchical Parallelism<a class="headerlink" href="#hierarchical-parallelism" title="Link to this heading">¶</a></h3>
<p>KokkosBatched employs a sophisticated hierarchical parallelism model that maps efficiently to modern hardware architectures. This model incorporates:</p>
<ol class="arabic simple">
<li><p><strong>Batch-level parallelism</strong>: Different batch elements are distributed across computational resources (e.g., thread blocks on GPUs, cores on CPUs)</p></li>
<li><p><strong>Team-level parallelism</strong>: Multiple threads cooperate on individual problems</p></li>
<li><p><strong>Vector-level parallelism</strong>: SIMD/vector instructions are leveraged for computational kernels</p></li>
</ol>
<p>This can be mathematically conceptualized as a decomposition of the computation space. For an operation like batched matrix-vector multiplication:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[y_{b,i} = \sum_{j=0}^{n-1} A_{b,i,j} \cdot x_{b,j}\]</div>
</div>
<p>Where:
- The batch dimension <span class="math notranslate nohighlight">\(b \in [0, \text{batch\_size} - 1]\)</span> is mapped to the coarsest parallelism level
- The row dimension <span class="math notranslate nohighlight">\(i \in [0, m - 1]\)</span> is potentially mapped to team-level parallelism
- The inner products are potentially mapped to vector-level parallelism</p>
<p>The library provides distinct implementation variants for each parallelism model:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Serial</span></code>: No internal parallelism</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Team</span></code>: Team-based parallelism</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TeamVector</span></code>: Both team and vector parallelism</p></li>
</ul>
<p>For example, the invocation pattern for a batched matrix-vector multiplication might follow:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{KokkosBatched::Spmv}&lt;\text{MemberType}, \text{Trans::NoTranspose}, \text{Mode::TeamVector}&gt;::\text{invoke}(\text{member}, \alpha, \text{values}, \text{row\_ptr}, \text{col\_idx}, x, \beta, y)\]</div>
</div>
<p>This mathematical formulation naturally extends to complex operations like iterative solvers, where multiple complex linear algebra operations are orchestrated to solve batched systems of equations.</p>
</section>
</section>
<section id="dense-linear-algebra-operations">
<h2>Dense Linear Algebra Operations<a class="headerlink" href="#dense-linear-algebra-operations" title="Link to this heading">¶</a></h2>
<p>KokkosBatched offers a comprehensive suite of dense linear algebra operations organized in a BLAS-like hierarchy:</p>
<section id="blas-level-1-vector-vector-operations">
<h3>BLAS Level 1 (Vector-Vector Operations)<a class="headerlink" href="#blas-level-1-vector-vector-operations" title="Link to this heading">¶</a></h3>
<p>These operations involve vectors and have computational complexity of <span class="math notranslate nohighlight">\(O(n)\)</span>.</p>
<ol class="arabic">
<li><p><strong>AddRadial</strong>: Adds scalar values to diagonal elements</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A_{ii} = A_{ii} + \alpha \quad \forall i\]</div>
</div>
</li>
<li><p><strong>Norm2</strong>: Computes the Euclidean norm of a vector</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\|x\|_2 = \sqrt{\sum_{i=0}^{n-1} |x_i|^2}\]</div>
</div>
</li>
<li><p><strong>Axpy</strong>: Scaled vector addition</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[y_i = \alpha \cdot x_i + y_i \quad \forall i\]</div>
</div>
</li>
<li><p><strong>Dot</strong>: Inner product of two vectors</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{dot}(x, y) = \sum_{i=0}^{n-1} x_i \cdot y_i\]</div>
</div>
</li>
</ol>
</section>
<section id="blas-level-2-matrix-vector-operations">
<h3>BLAS Level 2 (Matrix-Vector Operations)<a class="headerlink" href="#blas-level-2-matrix-vector-operations" title="Link to this heading">¶</a></h3>
<p>These operations involve a matrix and vector, with computational complexity of <span class="math notranslate nohighlight">\(O(n^2)\)</span>.</p>
<ol class="arabic">
<li><p><strong>Gemv</strong>: General matrix-vector multiplication</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[y_i = \alpha \sum_{j=0}^{n-1} A_{ij} \cdot x_j + \beta \cdot y_i \quad \forall i\]</div>
</div>
</li>
<li><p><strong>Trsv</strong>: Triangular solve</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A \cdot x = b\]</div>
</div>
<p>Where <span class="math notranslate nohighlight">\(A\)</span> is triangular, solved via forward or backward substitution.</p>
</li>
<li><p><strong>Syr</strong>: Symmetric rank-1 update</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A = \alpha \cdot x \cdot x^T + A\]</div>
</div>
</li>
</ol>
</section>
<section id="blas-level-3-matrix-matrix-operations">
<h3>BLAS Level 3 (Matrix-Matrix Operations)<a class="headerlink" href="#blas-level-3-matrix-matrix-operations" title="Link to this heading">¶</a></h3>
<p>These involve matrices with computational complexity of <span class="math notranslate nohighlight">\(O(n^3)\)</span>.</p>
<ol class="arabic">
<li><p><strong>Gemm</strong>: General matrix-matrix multiplication</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[C_{ij} = \alpha \sum_{k=0}^{n-1} A_{ik} \cdot B_{kj} + \beta \cdot C_{ij} \quad \forall i,j\]</div>
</div>
</li>
<li><p><strong>Trsm</strong>: Triangular solve with multiple right-hand sides</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A \cdot X = B\]</div>
</div>
<p>Where <span class="math notranslate nohighlight">\(A\)</span> is triangular and <span class="math notranslate nohighlight">\(X, B\)</span> are matrices.</p>
</li>
</ol>
</section>
<section id="matrix-factorizations">
<h3>Matrix Factorizations<a class="headerlink" href="#matrix-factorizations" title="Link to this heading">¶</a></h3>
<p>KokkosBatched provides essential matrix factorization operations that decompose matrices into specialized forms:</p>
<ol class="arabic">
<li><p><strong>LU Factorization</strong> (Getrf/Gbtrf/Pbtrf): Decomposes a matrix into lower and upper triangular factors</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A = P \cdot L \cdot U\]</div>
</div>
<p>Where <span class="math notranslate nohighlight">\(P\)</span> is a permutation matrix, <span class="math notranslate nohighlight">\(L\)</span> is lower triangular with unit diagonal, and <span class="math notranslate nohighlight">\(U\)</span> is upper triangular.</p>
</li>
<li><p><strong>QR Factorization</strong>: Decomposes a matrix into an orthogonal matrix and an upper triangular matrix</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A = Q \cdot R\]</div>
</div>
<p>Where <span class="math notranslate nohighlight">\(Q\)</span> is orthogonal and <span class="math notranslate nohighlight">\(R\)</span> is upper triangular.</p>
</li>
<li><p><strong>UTV Factorization</strong>: Rank-revealing decomposition useful for ill-conditioned matrices</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A = U \cdot T \cdot V^T\]</div>
</div>
<p>Where <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> are orthogonal, and <span class="math notranslate nohighlight">\(T\)</span> is triangular.</p>
</li>
<li><p><strong>Cholesky Factorization</strong>: For symmetric positive definite matrices</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A = L \cdot L^T\]</div>
</div>
<p>Where <span class="math notranslate nohighlight">\(L\)</span> is lower triangular.</p>
</li>
</ol>
</section>
</section>
<section id="sparse-linear-algebra-operations">
<h2>Sparse Linear Algebra Operations<a class="headerlink" href="#sparse-linear-algebra-operations" title="Link to this heading">¶</a></h2>
<p>KokkosBatched extends the batched paradigm to sparse matrices, offering significant performance advantages for applications with many sparse operations. The fundamental abstraction is the batched CRS (Compressed Row Storage) matrix, where matrices with identical sparsity patterns but different values are stored efficiently.</p>
<section id="sparse-matrix-representation">
<h3>Sparse Matrix Representation<a class="headerlink" href="#sparse-matrix-representation" title="Link to this heading">¶</a></h3>
<p>For a batch of <span class="math notranslate nohighlight">\(B\)</span> sparse matrices sharing the same sparsity pattern, KokkosBatched uses:</p>
<ol class="arabic simple">
<li><p>A single row pointer array <code class="docutils literal notranslate"><span class="pre">row_ptr</span></code> (size <span class="math notranslate nohighlight">\(n+1\)</span>)</p></li>
<li><p>A single column indices array <code class="docutils literal notranslate"><span class="pre">col_idx</span></code> (size <span class="math notranslate nohighlight">\(nnz\)</span>)</p></li>
<li><p>A values array <code class="docutils literal notranslate"><span class="pre">values</span></code> (size <span class="math notranslate nohighlight">\(B \times nnz\)</span>)</p></li>
</ol>
<p>This representation minimizes memory consumption while enabling efficient computational kernels.</p>
</section>
<section id="sparse-matrix-operations">
<h3>Sparse Matrix Operations<a class="headerlink" href="#sparse-matrix-operations" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><p><strong>Spmv</strong>: Sparse matrix-vector multiplication</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[y_{b,i} = \alpha_b \sum_{j=0}^{n-1} A_{b,i,j} \cdot x_{b,j} + \beta_b \cdot y_{b,i}\]</div>
</div>
<p>Where the summation only includes non-zero elements of the sparse matrix <span class="math notranslate nohighlight">\(A_b\)</span>.</p>
</li>
<li><p><strong>CrsMatrix</strong>: A class encapsulating the batched CRS matrix with optimized apply methods</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{apply}: Y = \alpha \cdot A \cdot X + \beta \cdot Y\]</div>
</div>
<p>This operation leverages specialized kernels for different parallelism models.</p>
</li>
</ol>
</section>
</section>
<section id="iterative-solvers">
<h2>Iterative Solvers<a class="headerlink" href="#iterative-solvers" title="Link to this heading">¶</a></h2>
<p>KokkosBatched provides state-of-the-art iterative solvers for batched linear systems, essential for applications requiring the solution of many independent equations.</p>
<section id="krylov-subspace-methods">
<h3>Krylov Subspace Methods<a class="headerlink" href="#krylov-subspace-methods" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><p><strong>Conjugate Gradient (CG)</strong>: For symmetric positive definite systems</p>
<p>The CG method minimizes the energy norm <span class="math notranslate nohighlight">\(\|x - x^*\|_A\)</span> where <span class="math notranslate nohighlight">\(x^*\)</span> is the exact solution, and <span class="math notranslate nohighlight">\(\|x\|_A = \sqrt{x^T A x}\)</span>. Each iteration involves:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
r^{(k)} &amp;= b - A x^{(k)} \\
\alpha_k &amp;= \frac{r^{(k)T} r^{(k)}}{p^{(k)T} A p^{(k)}} \\
x^{(k+1)} &amp;= x^{(k)} + \alpha_k p^{(k)} \\
r^{(k+1)} &amp;= r^{(k)} - \alpha_k A p^{(k)} \\
\beta_k &amp;= \frac{r^{(k+1)T} r^{(k+1)}}{r^{(k)T} r^{(k)}} \\
p^{(k+1)} &amp;= r^{(k+1)} + \beta_k p^{(k)}
\end{align}\end{split}\]</div>
</div>
</li>
<li><p><strong>Generalized Minimal Residual (GMRES)</strong>: For general non-symmetric systems</p>
<p>GMRES minimizes the Euclidean norm of the residual <span class="math notranslate nohighlight">\(\|b - A x^{(k)}\|_2\)</span> over the Krylov subspace <span class="math notranslate nohighlight">\(\mathcal{K}_k(A, r^{(0)}) = \text{span}\{r^{(0)}, A r^{(0)}, \ldots, A^{k-1} r^{(0)}\}\)</span>.</p>
<p>The method employs the Arnoldi process to construct an orthonormal basis <span class="math notranslate nohighlight">\(\{v_1, v_2, \ldots, v_k\}\)</span> for the Krylov subspace:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
v_1 &amp;= \frac{r^{(0)}}{\|r^{(0)}\|_2} \\
h_{ij} &amp;= (A v_j, v_i) \quad \text{for } i = 1, 2, \ldots, j \\
\tilde{v}_{j+1} &amp;= A v_j - \sum_{i=1}^{j} h_{ij} v_i \\
h_{j+1,j} &amp;= \|\tilde{v}_{j+1}\|_2 \\
v_{j+1} &amp;= \frac{\tilde{v}_{j+1}}{h_{j+1,j}}
\end{align}\end{split}\]</div>
</div>
<p>The approximate solution is then computed as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[x^{(k)} = x^{(0)} + V_k y_k\]</div>
</div>
<p>Where <span class="math notranslate nohighlight">\(y_k\)</span> minimizes <span class="math notranslate nohighlight">\(\|\beta e_1 - \bar{H}_k y\|_2\)</span>, with <span class="math notranslate nohighlight">\(\beta = \|r^{(0)}\|_2\)</span>, <span class="math notranslate nohighlight">\(e_1\)</span> being the first unit vector, and <span class="math notranslate nohighlight">\(\bar{H}_k\)</span> the upper Hessenberg matrix formed by the coefficients <span class="math notranslate nohighlight">\(h_{ij}\)</span>.</p>
</li>
</ol>
</section>
<section id="preconditioning">
<h3>Preconditioning<a class="headerlink" href="#preconditioning" title="Link to this heading">¶</a></h3>
<p>KokkosBatched offers several preconditioners to accelerate convergence:</p>
<ol class="arabic">
<li><p><strong>JacobiPrec</strong>: Diagonal (Jacobi) preconditioner</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[M^{-1} = \text{diag}(A)^{-1}\]</div>
</div>
</li>
<li><p><strong>Identity</strong>: Identity preconditioner (no preconditioning)</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[M^{-1} = I\]</div>
</div>
</li>
</ol>
<p>The preconditioned systems transform the original system <span class="math notranslate nohighlight">\(A x = b\)</span> into either:</p>
<ul class="simple">
<li><p>Left-preconditioned: <span class="math notranslate nohighlight">\(M^{-1} A x = M^{-1} b\)</span></p></li>
<li><p>Right-preconditioned: <span class="math notranslate nohighlight">\(A M^{-1} y = b\)</span>, where <span class="math notranslate nohighlight">\(x = M^{-1} y\)</span></p></li>
</ul>
</section>
<section id="the-krylovhandle-infrastructure">
<h3>The KrylovHandle Infrastructure<a class="headerlink" href="#the-krylovhandle-infrastructure" title="Link to this heading">¶</a></h3>
<p>The iterative solvers are orchestrated through the <code class="docutils literal notranslate"><span class="pre">KrylovHandle</span></code> class, which provides:</p>
<ol class="arabic simple">
<li><p>Workspace allocation for solver-specific data structures</p></li>
<li><p>Storage for convergence history</p></li>
<li><p>Tolerance and iteration control</p></li>
<li><p>Methods to query solution status</p></li>
</ol>
<p>This infrastructure enables efficient and flexible configuration of the iterative solvers.</p>
</section>
</section>
<section id="implementation-details-and-performance-optimization">
<h2>Implementation Details and Performance Optimization<a class="headerlink" href="#implementation-details-and-performance-optimization" title="Link to this heading">¶</a></h2>
<section id="memory-layout-considerations">
<h3>Memory Layout Considerations<a class="headerlink" href="#memory-layout-considerations" title="Link to this heading">¶</a></h3>
<p>KokkosBatched leverages Kokkos’ powerful memory layout abstractions to optimize data access patterns. For optimal performance, batch dimensions are typically placed in the leftmost position, allowing for coalesced memory access in GPU implementations:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{data}[\text{batch\_index}][\text{row}][\text{column}]\]</div>
</div>
<p>This corresponds to a <code class="docutils literal notranslate"><span class="pre">LayoutLeft</span></code> in Kokkos terminology for row-major storage, ensuring efficient memory access patterns on both CPUs and GPUs.</p>
</section>
<section id="algorithmic-variants">
<h3>Algorithmic Variants<a class="headerlink" href="#algorithmic-variants" title="Link to this heading">¶</a></h3>
<p>Many operations in KokkosBatched provide multiple algorithmic variants to accommodate different problem characteristics:</p>
<ol class="arabic simple">
<li><p><strong>Blocked vs. Unblocked</strong>: For operations like LU factorization, blocked variants exploit cache hierarchy for large matrices, while unblocked variants minimize overhead for very small matrices.</p></li>
<li><p><strong>Orthogonalization Strategies</strong>: For GMRES, both Classical and Modified Gram-Schmidt orthogonalization strategies are available, with different stability-performance tradeoffs.</p></li>
</ol>
</section>
<section id="sparse-specific-optimizations">
<h3>Sparse-Specific Optimizations<a class="headerlink" href="#sparse-specific-optimizations" title="Link to this heading">¶</a></h3>
<p>Sparse operations employ specialized techniques:</p>
<ol class="arabic simple">
<li><p><strong>Thread cooperation schemes</strong>: Threads within a team cooperate on rows or non-zero elements depending on matrix characteristics.</p></li>
<li><p><strong>Vectorization strategies</strong>: For structured sparsity patterns, vector-level parallelism is exploited.</p></li>
<li><p><strong>Load balancing</strong>: Sophisticated work distribution ensures balanced workloads despite irregular sparsity patterns.</p></li>
</ol>
</section>
<section id="comparative-performance">
<h3>Comparative Performance<a class="headerlink" href="#comparative-performance" title="Link to this heading">¶</a></h3>
<p>KokkosBatched demonstrates significant performance advantages over traditional approaches. For example, batched LU factorization of 1000 matrices of size 32×32 can achieve speedups of 5-10× compared to sequential processing, with the advantage growing as batch sizes increase.</p>
<p>The figure below illustrates the typical performance scaling observed with KokkosBatched operations:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Performance scaling with batch size (schematic):

^
|                                                 *
|                                           *
|                                     *
|                               *
|                         *
|                   *
|             *
|       *
| *
+--------------------------------------------------&gt;
  1    10    100   1000  10000 100000  Batch Size
</pre></div>
</div>
<p>This nonlinear scaling demonstrates the benefits of amortizing kernel launch overhead and improving computational intensity.</p>
</section>
</section>
<section id="usage-patterns-and-api-design">
<h2>Usage Patterns and API Design<a class="headerlink" href="#usage-patterns-and-api-design" title="Link to this heading">¶</a></h2>
<p>KokkosBatched employs a consistent API design pattern across operations, making it intuitive to use once the basic paradigm is understood.</p>
<section id="execution-model-selection">
<h3>Execution Model Selection<a class="headerlink" href="#execution-model-selection" title="Link to this heading">¶</a></h3>
<p>Operations can be invoked with different execution models:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Serial execution</span>
<span class="n">KokkosBatched</span><span class="o">::</span><span class="n">SerialLU</span><span class="o">::</span><span class="n">invoke</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>

<span class="c1">// Team execution</span>
<span class="n">KokkosBatched</span><span class="o">::</span><span class="n">TeamLU</span><span class="o">&lt;</span><span class="n">MemberType</span><span class="o">&gt;::</span><span class="n">invoke</span><span class="p">(</span><span class="n">member</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">);</span>

<span class="c1">// Team-Vector execution</span>
<span class="n">KokkosBatched</span><span class="o">::</span><span class="n">TeamVectorLU</span><span class="o">&lt;</span><span class="n">MemberType</span><span class="o">&gt;::</span><span class="n">invoke</span><span class="p">(</span><span class="n">member</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
<p>Alternatively, a unified interface with mode selection is provided:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">KokkosBatched</span><span class="o">::</span><span class="n">LU</span><span class="o">&lt;</span><span class="n">MemberType</span><span class="p">,</span><span class="w"> </span><span class="n">KokkosBatched</span><span class="o">::</span><span class="n">Mode</span><span class="o">::</span><span class="n">TeamVector</span><span class="o">&gt;::</span><span class="n">invoke</span><span class="p">(</span><span class="n">member</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="operator-models">
<h3>Operator Models<a class="headerlink" href="#operator-models" title="Link to this heading">¶</a></h3>
<p>For iterative solvers, KokkosBatched uses an operator model where matrix operations are encapsulated in classes providing an <code class="docutils literal notranslate"><span class="pre">apply</span></code> method:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">MemberType</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">ArgMode</span><span class="o">&gt;</span>
<span class="n">KOKKOS_INLINE_FUNCTION</span>
<span class="kt">void</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MemberType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">member</span><span class="p">,</span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="n">XViewType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">X</span><span class="p">,</span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="n">YViewType</span><span class="o">&amp;</span><span class="w"> </span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="p">;</span>
</pre></div>
</div>
<p>This allows composing complex operations from simpler building blocks, such as creating preconditioned operators.</p>
</section>
<section id="advanced-example-preconditioned-gmres">
<h3>Advanced Example: Preconditioned GMRES<a class="headerlink" href="#advanced-example-preconditioned-gmres" title="Link to this heading">¶</a></h3>
<p>A sophisticated example demonstrating the library’s capabilities is a preconditioned GMRES solve for multiple systems:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Create batched CRS matrix</span>
<span class="k">auto</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KokkosBatched</span><span class="o">::</span><span class="n">CrsMatrix</span><span class="o">&lt;</span><span class="n">values_type</span><span class="p">,</span><span class="w"> </span><span class="n">index_type</span><span class="o">&gt;</span><span class="p">(</span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">row_ptr</span><span class="p">,</span><span class="w"> </span><span class="n">col_idx</span><span class="p">);</span>

<span class="c1">// Create Jacobi preconditioner</span>
<span class="k">auto</span><span class="w"> </span><span class="n">prec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KokkosBatched</span><span class="o">::</span><span class="n">JacobiPrec</span><span class="o">&lt;</span><span class="n">diag_type</span><span class="o">&gt;</span><span class="p">(</span><span class="n">diag_values</span><span class="p">);</span>

<span class="c1">// Configure Krylov handle</span>
<span class="k">auto</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KokkosBatched</span><span class="o">::</span><span class="n">KrylovHandle</span><span class="o">&lt;</span><span class="n">norm_type</span><span class="p">,</span><span class="w"> </span><span class="n">int_type</span><span class="p">,</span><span class="w"> </span><span class="n">view3d_type</span><span class="o">&gt;</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span><span class="w"> </span><span class="n">n_team</span><span class="p">);</span>
<span class="n">handle</span><span class="p">.</span><span class="n">set_tolerance</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">);</span>
<span class="n">handle</span><span class="p">.</span><span class="n">set_max_iteration</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="n">handle</span><span class="p">.</span><span class="n">allocate_workspace</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">max_krylov_dim</span><span class="p">);</span>

<span class="c1">// Solve with GMRES</span>
<span class="n">Kokkos</span><span class="o">::</span><span class="n">parallel_for</span><span class="p">(</span><span class="n">policy</span><span class="p">,</span><span class="w"> </span><span class="n">KOKKOS_LAMBDA</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">member_type</span><span class="o">&amp;</span><span class="w"> </span><span class="n">member</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">member</span><span class="p">.</span><span class="n">league_rank</span><span class="p">();</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">B_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">subview</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">ALL</span><span class="p">());</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">X_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">subview</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">Kokkos</span><span class="o">::</span><span class="n">ALL</span><span class="p">());</span>

<span class="w">  </span><span class="n">KokkosBatched</span><span class="o">::</span><span class="n">GMRES</span><span class="o">&lt;</span><span class="n">member_type</span><span class="p">,</span><span class="w"> </span><span class="n">KokkosBatched</span><span class="o">::</span><span class="n">Mode</span><span class="o">::</span><span class="n">TeamVector</span><span class="o">&gt;</span>
<span class="w">    </span><span class="o">::</span><span class="n">invoke</span><span class="p">(</span><span class="n">member</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B_b</span><span class="p">,</span><span class="w"> </span><span class="n">X_b</span><span class="p">,</span><span class="w"> </span><span class="n">prec</span><span class="p">,</span><span class="w"> </span><span class="n">handle</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>This example demonstrates the elegant composition of components to solve complex problems with minimal code.</p>
</section>
</section>
<section id="applications-and-use-cases">
<h2>Applications and Use Cases<a class="headerlink" href="#applications-and-use-cases" title="Link to this heading">¶</a></h2>
<p>KokkosBatched finds applications across numerous domains:</p>
<ol class="arabic simple">
<li><p><strong>Computational Fluid Dynamics</strong>: Implicit time-stepping schemes require solving many similar systems</p></li>
<li><p><strong>Finite Element Analysis</strong>: Element-wise operations on unstructured meshes</p></li>
<li><p><strong>Quantum Chemistry</strong>: Electronic structure calculations with many small dense matrices</p></li>
<li><p><strong>Uncertainty Quantification</strong>: Ensemble methods requiring solutions for multiple parameter sets</p></li>
<li><p><strong>Machine Learning</strong>: Batched operations for mini-batch processing</p></li>
</ol>
<p>Each of these domains benefits from both the performance advantages and the simplified programming model that KokkosBatched provides.</p>
</section>
<section id="future-directions">
<h2>Future Directions<a class="headerlink" href="#future-directions" title="Link to this heading">¶</a></h2>
<p>The development of KokkosBatched can evolve in several directions:</p>
<ol class="arabic simple">
<li><p><strong>Tensor Contractions</strong>: Extending to higher-dimensional tensors</p></li>
<li><p><strong>Mixed Precision</strong>: Leveraging specialized hardware for lower precision arithmetic</p></li>
<li><p><strong>Adaptive Algorithms</strong>: Selecting optimal algorithms based on problem characteristics</p></li>
<li><p><strong>Sparse Tensor Operations</strong>: Extending the batched paradigm to sparse tensors</p></li>
<li><p><strong>Domain-Specific Preconditioners</strong>: Tailored preconditioning strategies for specific applications</p></li>
</ol>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>KokkosBatched represents a significant advancement in high-performance computing, addressing the critical need for efficient batched operations in scientific computing. By combining mathematical rigor with performance-oriented design, the library enables applications to achieve unprecedented performance on modern manycore architectures without sacrificing portability.</p>
<p>The library’s comprehensive coverage of dense and sparse operations, sophisticated linear solvers, and flexible preconditioning options make it an invaluable tool for computational scientists and engineers dealing with multiple small-to-medium sized problems.</p>
<p>Through its integration with the Kokkos ecosystem, KokkosBatched ensures that applications can seamlessly leverage current and future high-performance computing architectures, providing a sustainable path forward for performance-critical scientific applications.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="batched/dense-index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">dense</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="blas/blas3_trsm.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">KokkosBlas::trsm</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS)
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">API: Batched</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#mathematical-foundation">Mathematical Foundation</a><ul>
<li><a class="reference internal" href="#batched-representation">Batched Representation</a></li>
<li><a class="reference internal" href="#hierarchical-parallelism">Hierarchical Parallelism</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dense-linear-algebra-operations">Dense Linear Algebra Operations</a><ul>
<li><a class="reference internal" href="#blas-level-1-vector-vector-operations">BLAS Level 1 (Vector-Vector Operations)</a></li>
<li><a class="reference internal" href="#blas-level-2-matrix-vector-operations">BLAS Level 2 (Matrix-Vector Operations)</a></li>
<li><a class="reference internal" href="#blas-level-3-matrix-matrix-operations">BLAS Level 3 (Matrix-Matrix Operations)</a></li>
<li><a class="reference internal" href="#matrix-factorizations">Matrix Factorizations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sparse-linear-algebra-operations">Sparse Linear Algebra Operations</a><ul>
<li><a class="reference internal" href="#sparse-matrix-representation">Sparse Matrix Representation</a></li>
<li><a class="reference internal" href="#sparse-matrix-operations">Sparse Matrix Operations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#iterative-solvers">Iterative Solvers</a><ul>
<li><a class="reference internal" href="#krylov-subspace-methods">Krylov Subspace Methods</a></li>
<li><a class="reference internal" href="#preconditioning">Preconditioning</a></li>
<li><a class="reference internal" href="#the-krylovhandle-infrastructure">The KrylovHandle Infrastructure</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation-details-and-performance-optimization">Implementation Details and Performance Optimization</a><ul>
<li><a class="reference internal" href="#memory-layout-considerations">Memory Layout Considerations</a></li>
<li><a class="reference internal" href="#algorithmic-variants">Algorithmic Variants</a></li>
<li><a class="reference internal" href="#sparse-specific-optimizations">Sparse-Specific Optimizations</a></li>
<li><a class="reference internal" href="#comparative-performance">Comparative Performance</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage-patterns-and-api-design">Usage Patterns and API Design</a><ul>
<li><a class="reference internal" href="#execution-model-selection">Execution Model Selection</a></li>
<li><a class="reference internal" href="#operator-models">Operator Models</a></li>
<li><a class="reference internal" href="#advanced-example-preconditioned-gmres">Advanced Example: Preconditioned GMRES</a></li>
</ul>
</li>
<li><a class="reference internal" href="#applications-and-use-cases">Applications and Use Cases</a></li>
<li><a class="reference internal" href="#future-directions">Future Directions</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=4e2eecee"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=ff8fa330"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>
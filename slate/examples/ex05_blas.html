

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Example 05: BLAS Operations &mdash; SLATE 2023.11.05 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c74a7515" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=4a0eadb2"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script>window.MathJax = {"tex": {"macros": {"RR": "\\mathbb{R}", "CC": "\\mathbb{C}"}}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example 06: Linear Systems (LU)" href="ex06_linear_system_lu.html" />
    <link rel="prev" title="Example 04: Matrix Norms" href="ex04_norm.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../index.html" class="icon icon-home">
            SLATE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">USER GUIDE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/overview.html#design-goals">Design Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/overview.html#software-requirements">Software Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/overview.html#project-resources">Project Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/getting_started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/getting_started.html#example-program-lu-solve">Example Program: LU Solve</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/getting_started.html#understanding-the-example">Understanding the Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/getting_started.html#mpi-initialization">MPI Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/getting_started.html#creating-matrices">Creating Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/getting_started.html#allocating-tiles">Allocating Tiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/getting_started.html#solving-the-system">Solving the System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/getting_started.html#execution-options">Execution Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/getting_started.html#building-the-example">Building the Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/getting_started.html#running-the-example">Running the Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/getting_started.html#simplifying-assumptions">Simplifying Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/getting_started.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/installation.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/installation.html#downloading-source">Downloading Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/installation.html#makefile-build">Makefile Build</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#basic-configuration">Basic Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#build-and-install">Build and Install</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#configuration-options">Configuration Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/installation.html#cmake-build">CMake Build</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#basic-build">Basic Build</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#cmake-options">CMake Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#example-with-mkl-and-cuda">Example with MKL and CUDA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/installation.html#spack-installation">Spack Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#install-spack">Install Spack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#install-slate">Install SLATE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#loading-slate">Loading SLATE</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/installation.html#gpu-aware-mpi">GPU-Aware MPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/installation.html#verifying-installation">Verifying Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/installation.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#common-issues">Common Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/installation.html#getting-help">Getting Help</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/installation.html#module-environment-hpc-systems">Module Environment (HPC Systems)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/matrices.html">Matrices in SLATE</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/matrices.html#matrix-hierarchy">Matrix Hierarchy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#matrix-types">Matrix Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/matrices.html#creating-matrices">Creating Matrices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#basic-creation">Basic Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#creating-from-existing-matrix-structure">Creating from Existing Matrix Structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/matrices.html#allocating-tile-memory">Allocating Tile Memory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#cpu-host-memory">CPU Host Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#gpu-device-memory">GPU Device Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#user-provided-memory">User-Provided Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#scalapack-layout">ScaLAPACK Layout</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/matrices.html#accessing-matrix-elements">Accessing Matrix Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#tile-access">Tile Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#element-access">Element Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#matrix-properties">Matrix Properties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/matrices.html#matrix-conversions">Matrix Conversions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/matrices.html#transpose-and-conjugate-transpose">Transpose and Conjugate Transpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/matrices.html#submatrices-and-slices">Submatrices and Slices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#tile-based-submatrices">Tile-Based Submatrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#element-based-slices">Element-Based Slices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/matrices.html#copying-matrices">Copying Matrices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#deep-copy">Deep Copy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#precision-conversion">Precision Conversion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/matrices.html#tile-layout-and-distribution">Tile Layout and Distribution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#data-distribution">Data Distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#tile-sizes">Tile Sizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/matrices.html#memory-management">Memory Management</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/matrices.html#best-practices">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/operations.html">SLATE Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/operations.html#execution-options">Execution Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#common-options">Common Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/operations.html#matrix-norms">Matrix Norms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/operations.html#level-3-blas-operations">Level 3 BLAS Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#matrix-multiply-gemm">Matrix Multiply (gemm)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#hermitian-symmetric-matrix-multiply-hemm-symm">Hermitian/Symmetric Matrix Multiply (hemm/symm)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#rank-k-update-herk-syrk">Rank-k Update (herk/syrk)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#rank-2k-update-her2k-syr2k">Rank-2k Update (her2k/syr2k)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#triangular-multiply-trmm">Triangular Multiply (trmm)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#triangular-solve-trsm">Triangular Solve (trsm)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/operations.html#linear-systems">Linear Systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#lu-factorization-general-matrices">LU Factorization (General Matrices)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#lu-pivoting-options">LU Pivoting Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#cholesky-factorization-positive-definite">Cholesky Factorization (Positive Definite)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#indefinite-solve-aasen-s-algorithm">Indefinite Solve (Aasen’s Algorithm)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#band-matrix-solve">Band Matrix Solve</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/operations.html#mixed-precision-iterative-refinement">Mixed-Precision Iterative Refinement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/operations.html#least-squares">Least Squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/operations.html#qr-and-lq-factorizations">QR and LQ Factorizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/operations.html#eigenvalue-problems">Eigenvalue Problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#hermitian-symmetric-eigenvalues">Hermitian/Symmetric Eigenvalues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#eigenvalue-methods">Eigenvalue Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#generalized-eigenvalue-problem">Generalized Eigenvalue Problem</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/operations.html#singular-value-decomposition">Singular Value Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/operations.html#auxiliary-operations">Auxiliary Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#matrix-add">Matrix Add</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#matrix-copy">Matrix Copy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#matrix-set">Matrix Set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#matrix-scale">Matrix Scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#condition-number-estimate">Condition Number Estimate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/operations.html#matrix-print">Matrix Print</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/operations.html#naming-conventions">Naming Conventions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/testing.html">Testing and Tuning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/testing.html#slate-tester">SLATE Tester</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#single-process-testing">Single-Process Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#multi-process-testing">Multi-Process Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#tester-parameters">Tester Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#example-tester-output">Example Tester Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/testing.html#accuracy-verification">Accuracy Verification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#without-reference-ref-n">Without Reference (–ref=n)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#with-reference-ref-y">With Reference (–ref=y)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#norm-verification">Norm Verification</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/testing.html#full-testing-suite">Full Testing Suite</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#custom-test-commands">Custom Test Commands</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/testing.html#performance-tuning">Performance Tuning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#tile-size">Tile Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#process-grid">Process Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#lookahead">Lookahead</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#panel-threads">Panel Threads</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#multi-threaded-mpi-broadcast">Multi-threaded MPI Broadcast</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#gpu-aware-mpi">GPU-Aware MPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#performance-examples">Performance Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/testing.html#unit-tests">Unit Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/testing.html#benchmark-suite">Benchmark Suite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/testing.html#troubleshooting-tests">Troubleshooting Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#common-issues">Common Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/testing.html#debugging">Debugging</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/compatibility.html">ScaLAPACK Compatibility</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/compatibility.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/compatibility.html#lapack-compatibility-api">LAPACK Compatibility API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#using-the-api">Using the API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#how-it-works">How It Works</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#tile-size">Tile Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#available-routines">Available Routines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/compatibility.html#scalapack-compatibility-api">ScaLAPACK Compatibility API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#id1">Using the API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#id2">How It Works</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#id3">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#supported-routines">Supported Routines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/compatibility.html#matrix-layout-compatibility">Matrix Layout Compatibility</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#creating-from-scalapack-data">Creating from ScaLAPACK Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#grid-order">Grid Order</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/compatibility.html#migration-strategies">Migration Strategies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#gradual-migration">Gradual Migration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#direct-migration">Direct Migration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/compatibility.html#performance-considerations">Performance Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#id4">Tile Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/compatibility.html#gpu-acceleration">GPU Acceleration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/compatibility.html#limitations">Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/compatibility.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API REFERENCE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/slate/index.html">slate</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/slate/index.html#quick-reference">Quick Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/slate/index.html#contents">Contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/slate/blas.html">BLAS and Auxiliary Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/blas.html#matrix-multiplication">Matrix Multiplication</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/blas.html#triangular-matrix-multiplication">Triangular Matrix Multiplication</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/blas.html#rank-updates">Rank Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/blas.html#triangular-solve">Triangular Solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/blas.html#auxiliary-routines">Auxiliary Routines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/blas.html#standard-blas-routines">Standard BLAS Routines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/slate/linear_systems.html">Linear Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/linear_systems.html#lu-factorization-general">LU Factorization (General)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/linear_systems.html#cholesky-factorization-positive-definite">Cholesky Factorization (Positive Definite)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/linear_systems.html#indefinite-factorization-symmetric-hermitian">Indefinite Factorization (Symmetric/Hermitian)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/slate/least_squares.html">Least Squares</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/least_squares.html#least-squares-solve">Least Squares Solve</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/least_squares.html#qr-factorization">QR Factorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/least_squares.html#lq-factorization">LQ Factorization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/slate/eigenvalues.html">Eigenvalue Problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/eigenvalues.html#symmetric-hermitian-eigenvalue-problems">Symmetric/Hermitian Eigenvalue Problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/eigenvalues.html#generalized-symmetric-hermitian-eigenvalue-problems">Generalized Symmetric/Hermitian Eigenvalue Problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/eigenvalues.html#tridiagonal-eigenvalue-solvers">Tridiagonal Eigenvalue Solvers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/slate/svd.html">Singular Value Decomposition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/svd.html#svd-functions">SVD Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/svd.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/slate/matrices_api.html">Matrix Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/matrices_api.html#general-matrices">General Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/matrices_api.html#structured-matrices">Structured Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/matrices_api.html#band-matrices">Band Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/matrices_api.html#tiles">Tiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/matrices_api.html#auxiliary-classes">Auxiliary Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/slate/enums.html">Enumerations and Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/enums.html#core-enumerations">Core Enumerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/enums.html#options">Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/enums.html#method-enumerations">Method Enumerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/slate/enums.html#type-traits">Type Traits</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/slate/index.html#data-types">Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/slate/index.html#common-parameters">Common Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/slate/index.html#_CPPv4I0E7routinevR6MatrixI8scalar_tERK7Options"><code class="docutils literal notranslate"><span class="pre">routine()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/slate/index.html#error-handling">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/slate/index.html#header-files">Header Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/slate/index.html#c-and-fortran-apis">C and Fortran APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/slate/index.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/blaspp/index.html">blaspp</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/blaspp/index.html#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/blaspp/index.html#organization">Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/blaspp/index.html#contents">Contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/level1.html">Level 1 BLAS (Vector Operations)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/blaspp/level1.html#operations">Operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/level2.html">Level 2 BLAS (Matrix-Vector Operations)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/blaspp/level2.html#operations">Operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/level3.html">Level 3 BLAS (Matrix-Matrix Operations)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/blaspp/level3.html#operations">Operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/util.html">Utilities and Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/blaspp/util.html#enumerations">Enumerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/blaspp/util.html#error-handling">Error Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/blaspp/util.html#type-traits-and-safety-functions">Type Traits and Safety Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/device.html">Device (GPU) Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/blaspp/device.html#queue-management">Queue Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/blaspp/device.html#device-memory-and-batch-operations">Device Memory and Batch Operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/performance.html">Performance Counting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/blaspp/performance.html#papi-counter-integration">PAPI Counter Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/blaspp/performance.html#flop-calculations">FLOP Calculations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/blaspp/performance.html#bandwidth-calculations">Bandwidth Calculations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/blaspp/index.html#quick-reference">Quick Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/index.html#level-1-blas-vector-vector">Level 1 BLAS (Vector-Vector)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/index.html#level-2-blas-matrix-vector">Level 2 BLAS (Matrix-Vector)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/index.html#level-3-blas-matrix-matrix">Level 3 BLAS (Matrix-Matrix)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/blaspp/index.html#basic-usage">Basic Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/index.html#cpu-host-operations">CPU (Host) Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/index.html#gpu-device-operations">GPU (Device) Operations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/blaspp/index.html#common-parameters">Common Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/index.html#layout">Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/index.html#op">Op</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/index.html#uplo">Uplo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/index.html#diag">Diag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/blaspp/index.html#side">Side</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/blaspp/index.html#data-types">Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/blaspp/index.html#header-files">Header Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/blaspp/index.html#error-handling">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/blaspp/index.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/lapackpp/index.html">lapackpp</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/lapackpp/util.html">Utilities and Enumerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/util.html#error-handling">Error Handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/util.html#_CPPv4N6lapack5ErrorE"><code class="docutils literal notranslate"><span class="pre">lapack::Error</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/util.html#enumerations">Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/util.html#version-information">Version Information</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/lapackpp/device.html">Device (GPU) Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/device.html#queue-management">Queue Management</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/device.html#_CPPv4N6lapack5QueueE"><code class="docutils literal notranslate"><span class="pre">lapack::Queue</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/device.html#gpu-operations">GPU Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/device.html#cholesky-factorization">Cholesky Factorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/device.html#lu-factorization">LU Factorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/device.html#qr-factorization">QR Factorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/device.html#eigenvalue-decomposition">Eigenvalue Decomposition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/device.html#device-memory-types">Device Memory Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/lapackpp/flops.html">Performance Counters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/flops.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/flops.html#flop-counting">FLOP Counting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/flops.html#_CPPv4I0EN6lapack5GflopE"><code class="docutils literal notranslate"><span class="pre">lapack::Gflop</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/flops.html#bandwidth-analysis">Bandwidth Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/flops.html#_CPPv4I0EN6lapack5GbyteE"><code class="docutils literal notranslate"><span class="pre">lapack::Gbyte</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/flops.html#usage-example">Usage Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/flops.html#supported-operations">Supported Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/flops.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/lapackpp/factorizations.html">Matrix Factorizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#lu-factorization">LU Factorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#cholesky-factorization">Cholesky Factorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#qr-factorization">QR Factorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#lq-factorization">LQ Factorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#ql-factorization">QL Factorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#rq-factorization">RQ Factorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#symmetric-hermitian-factorizations">Symmetric/Hermitian Factorizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#triangular-factorizations">Triangular Factorizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#bidiagonal-reduction">Bidiagonal Reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#tridiagonal-reduction">Tridiagonal Reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#hessenberg-reduction">Hessenberg Reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#example-usage">Example Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#factorization-algorithms">Factorization Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#storage-efficiency">Storage Efficiency</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#performance-characteristics">Performance Characteristics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#blocking-and-level-3-blas">Blocking and Level-3 BLAS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#choosing-a-factorization">Choosing a Factorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/factorizations.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/lapackpp/linear_systems.html">Linear Systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/linear_systems.html#general-non-symmetric-systems">General (Non-Symmetric) Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/linear_systems.html#symmetric-hermitian-positive-definite">Symmetric/Hermitian Positive Definite</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/linear_systems.html#symmetric-hermitian-indefinite">Symmetric/Hermitian Indefinite</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/linear_systems.html#triangular-systems">Triangular Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/linear_systems.html#band-matrices">Band Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/linear_systems.html#tridiagonal-systems">Tridiagonal Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/linear_systems.html#symmetric-positive-definite-tridiagonal">Symmetric Positive Definite Tridiagonal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/linear_systems.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/lapackpp/least_squares.html">Least Squares and Linear Regression</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/least_squares.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/least_squares.html#qr-based-least-squares">QR-Based Least Squares</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/least_squares.html#qr-factorization">QR Factorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/least_squares.html#lq-factorization">LQ Factorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/least_squares.html#ql-and-rq-factorizations">QL and RQ Factorizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/least_squares.html#orthogonal-matrix-generation">Orthogonal Matrix Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/least_squares.html#multiplication-by-q">Multiplication by Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/least_squares.html#complete-orthogonal-factorization">Complete Orthogonal Factorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/least_squares.html#constrained-least-squares">Constrained Least Squares</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/least_squares.html#rank-estimation">Rank Estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/least_squares.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/lapackpp/eigenvalues.html">Eigenvalue Problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#standard-eigenvalue-problems">Standard Eigenvalue Problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#symmetric-hermitian-eigenvalues">Symmetric/Hermitian Eigenvalues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#non-symmetric-eigenvalues">Non-Symmetric Eigenvalues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#tridiagonal-banded-eigenproblems">Tridiagonal/Banded Eigenproblems</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#generalized-eigenvalue-problems">Generalized Eigenvalue Problems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#symmetric-hermitian">Symmetric/Hermitian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#non-symmetric-generalized-schur">Non-Symmetric (Generalized Schur)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#reduction-to-standard-form">Reduction to Standard Form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#auxiliary-reductions">Auxiliary Reductions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#schur-form-manipulation">Schur Form Manipulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#eigenvector-computation">Eigenvector Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#balancing">Balancing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#utility-functions">Utility Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/eigenvalues.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/lapackpp/svd.html">Singular Value Decomposition (SVD)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/svd.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/svd.html#standard-svd">Standard SVD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/svd.html#specialized-svd-routines">Specialized SVD Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/svd.html#bidiagonal-svd">Bidiagonal SVD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/svd.html#bidiagonal-reduction">Bidiagonal Reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/svd.html#generalized-svd-gsvd">Generalized SVD (GSVD)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/svd.html#cs-decomposition-csd">CS Decomposition (CSD)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/svd.html#utility-functions">Utility Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/svd.html#rank-and-pseudoinverse">Rank and Pseudoinverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/svd.html#applications">Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/svd.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/lapackpp/auxiliary.html">Auxiliary Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#matrix-norms">Matrix Norms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#condition-number-estimation">Condition Number Estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#equilibration-and-scaling">Equilibration and Scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#matrix-initialization-and-copying">Matrix Initialization and Copying</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#matrix-addition">Matrix Addition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#householder-transformations">Householder Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#givens-rotations">Givens Rotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#matrix-multiplication-triangular">Matrix Multiplication (Triangular)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#special-matrix-operations">Special Matrix Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#permutations-and-sorting">Permutations and Sorting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#workspace-queries">Workspace Queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#error-checking-and-diagnostics">Error Checking and Diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/lapackpp/auxiliary.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/lapackpp/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/lapackpp/index.html#key-features">Key Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/lapackpp/index.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EXAMPLES</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="building.html#option-1-makefile">Option 1: Makefile</a></li>
<li class="toctree-l2"><a class="reference internal" href="building.html#option-2-cmake">Option 2: CMake</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex01_matrix.html">Example 01: Matrix Construction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex01_matrix.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex01_matrix.html#c-example">C++ Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex02_conversion.html">Example 02: Matrix Type Conversion</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex02_conversion.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex02_conversion.html#c-example">C++ Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex03_submatrix.html">Example 03: Submatrices and Slicing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex03_submatrix.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex03_submatrix.html#c-example">C++ Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex04_norm.html">Example 04: Matrix Norms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex04_norm.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex04_norm.html#c-example">C++ Example</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example 05: BLAS Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#c-example">C++ Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#c-api-example">C API Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fortran-api-example">Fortran API Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex06_linear_system_lu.html">Example 06: Linear Systems (LU)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex06_linear_system_lu.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex06_linear_system_lu.html#c-example">C++ Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex06_linear_system_lu.html#c-api-example">C API Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex07_linear_system_cholesky.html">Example 07: Linear Systems (Cholesky)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex07_linear_system_cholesky.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex07_linear_system_cholesky.html#c-example">C++ Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex08_linear_system_indefinite.html">Example 08: Linear Systems (Indefinite)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex08_linear_system_indefinite.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex08_linear_system_indefinite.html#c-example">C++ Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex09_least_squares.html">Example 09: Least Squares</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex09_least_squares.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex09_least_squares.html#c-example">C++ Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex10_svd.html">Example 10: Singular Value Decomposition (SVD)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex10_svd.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex10_svd.html#c-example">C++ Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex11_hermitian_eig.html">Example 11: Hermitian Eigenvalue Problems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex11_hermitian_eig.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex11_hermitian_eig.html#c-example">C++ Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex12_generalized_hermitian_eig.html">Example 12: Generalized Hermitian Eigenvalues</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex12_generalized_hermitian_eig.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex12_generalized_hermitian_eig.html#c-example">C++ Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex13_non_uniform_block_size.html">Example 13: Non-uniform Block Sizes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex13_non_uniform_block_size.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex13_non_uniform_block_size.html#c-example">C++ Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex14_scalapack_gemm.html">Example 14: ScaLAPACK Compatibility</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex14_scalapack_gemm.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex14_scalapack_gemm.html#c-example">C++ Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ex15_set_matrix.html">Example 15: Setting Matrix Elements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ex15_set_matrix.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ex15_set_matrix.html#c-example">C++ Example</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DEVELOPER GUIDE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/01_introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/01_introduction.html#revision-notes">Revision Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/02_api_layers.html">API Layers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/02_api_layers.html#drivers">Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/02_api_layers.html#computational-routines">Computational Routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/02_api_layers.html#comments-on-the-code">Comments on the Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/02_api_layers.html#template-dispatch">Template Dispatch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/02_api_layers.html#executing-multiple-internal-routines-on-devices">Executing Multiple Internal Routines on Devices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/02_api_layers.html#internal-routines-for-major-parallel-tasks">Internal Routines for Major, Parallel Tasks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/02_api_layers.html#batched-gpu-tasks">Batched GPU Tasks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/02_api_layers.html#tile-operations-for-small-sequential-tasks">Tile Operations for Small, Sequential Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/02_api_layers.html#blas-batched-blas-and-lapack">BLAS++, Batched BLAS++, and LAPACK++</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/02_api_layers.html#work-routines-for-actual-openmp-work">Work Routines for Actual OpenMP Work</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/03_matrix_storage.html">Matrix Storage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/03_matrix_storage.html#tile-management">Tile Management</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/04_side_uplo_trans.html">Handling of Side, Uplo, Trans, etc.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/05_precisions.html">Handling of Precisions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/06_parallelism.html">Parallelism Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/07_communication.html">Message Passing Communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/08_mosi.html">MOSI Coherency Protocol</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/08_mosi.html#coherency-control">Coherency Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/08_mosi.html#tile-states">Tile States</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/08_mosi.html#mosi-api">MOSI API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/08_mosi.html#data-transfer">Data Transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/08_mosi.html#developer-hints">Developer Hints</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/09_layout.html">Column Major and Row Major Layout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/09_layout.html#layout-representation-and-api">Layout Representation and API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developer_guide/09_layout.html#layout-conversion">Layout Conversion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developer_guide/09_layout.html#layout-conversion-of-extended-tiles">Layout Conversion of Extended Tiles</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/10_bibliography.html">Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ADDITIONAL INFO</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About SLATE</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#key-features">Key Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#project-information">Project Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#version">Version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../license.html#bsd-3-clause-license">BSD 3-Clause License</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SLATE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Example 05: BLAS Operations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/ex05_blas.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="example-05-blas-operations">
<h1>Example 05: BLAS Operations<a class="headerlink" href="#example-05-blas-operations" title="Link to this heading"></a></h1>
<p>This example demonstrates how to perform Basic Linear Algebra Subprograms (BLAS) operations in SLATE.</p>
<section id="key-concepts">
<h2>Key Concepts<a class="headerlink" href="#key-concepts" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>Matrix Multiplication</strong>: Using <code class="docutils literal notranslate"><span class="pre">slate::multiply</span></code> (gemm, hemm, symm) for matrix products.</p></li>
<li><p><strong>Rank Updates</strong>: Performing rank-k (herk, syrk) and rank-2k (her2k, syr2k) updates.</p></li>
<li><p><strong>Triangular Operations</strong>: Triangular matrix multiplication (trmm) and solving triangular systems (trsm).</p></li>
<li><p><strong>Simplified vs Traditional API</strong>: Comparing the descriptive <code class="docutils literal notranslate"><span class="pre">multiply</span></code> API with the traditional BLAS-named API.</p></li>
</ol>
</section>
<section id="c-example">
<h2>C++ Example<a class="headerlink" href="#c-example" title="Link to this heading"></a></h2>
<p><strong>General Matrix Multiplication (GEMM) (Lines 36-40)</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// C = alpha A B + beta C</span>
<span class="n">slate</span><span class="o">::</span><span class="n">multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// simplified API</span>
<span class="n">slate</span><span class="o">::</span><span class="n">gemm</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">      </span><span class="c1">// traditional API</span>
</pre></div>
</div>
<p>Here we perform the standard operation <span class="math notranslate nohighlight">\(C = \alpha AB + \beta C\)</span>.</p>
<ul class="simple">
<li><p><cite>A</cite> is an <cite>m</cite> by <cite>k</cite> matrix.</p></li>
<li><p><cite>B</cite> is a <cite>k</cite> by <cite>n</cite> matrix.</p></li>
<li><p><cite>C</cite> is an <cite>m</cite> by <cite>n</cite> matrix.</p></li>
</ul>
<p>SLATE provides both a descriptive <cite>multiply</cite> routine and the traditional BLAS-named <cite>gemm</cite>. They are equivalent.</p>
<p><strong>GPU Execution with Options (Lines 43-52)</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">blas</span><span class="o">::</span><span class="n">get_device_count</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Options</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Option</span><span class="o">::</span><span class="n">Lookahead</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Option</span><span class="o">::</span><span class="n">Target</span><span class="p">,</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Target</span><span class="o">::</span><span class="n">Devices</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Most SLATE routines accept an <cite>Options</cite> map as the final argument. Here we:</p>
<ul class="simple">
<li><p>Set <cite>Target::Devices</cite> to offload computation to GPUs.</p></li>
<li><p>Set <cite>Lookahead</cite> to 2 to overlap communication and computation.</p></li>
</ul>
<p><strong>Transposed Multiplication (Lines 77-83)</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">AT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transpose</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="k">auto</span><span class="w"> </span><span class="n">BH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conj_transpose</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="n">slate</span><span class="o">::</span><span class="n">multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">AT</span><span class="p">,</span><span class="w"> </span><span class="n">BH</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
</pre></div>
</div>
<p>To compute <span class="math notranslate nohighlight">\(C = \alpha A^T B^H + \beta C\)</span>, we simply create transposed views <cite>AT</cite> and <cite>BH</cite> and pass them to the multiply function. SLATE detects the transposition flags on the views and handles the logic internally.</p>
<p><strong>Symmetric/Hermitian Multiplication (SYMM/HEMM) (Lines 97-118)</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">slate</span><span class="o">::</span><span class="n">multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">                  </span><span class="c1">// simplified</span>
<span class="n">slate</span><span class="o">::</span><span class="n">symm</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Side</span><span class="o">::</span><span class="n">Left</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">   </span><span class="c1">// traditional</span>
</pre></div>
</div>
<p>When <cite>A</cite> is a <cite>SymmetricMatrix</cite> (or <cite>HermitianMatrix</cite>), <cite>multiply</cite> automatically dispatches to the efficient symmetric/Hermitian algorithm (<cite>symm</cite>/<cite>hemm</cite>).</p>
<ul class="simple">
<li><p><cite>Side::Left</cite> means <span class="math notranslate nohighlight">\(C = \alpha A B + \beta C\)</span>.</p></li>
<li><p><cite>Side::Right</cite> means <span class="math notranslate nohighlight">\(C = \alpha B A + \beta C\)</span> (demonstrated in lines 141-147).</p></li>
</ul>
<p><strong>Rank-K Updates (SYRK/HERK) (Lines 230-241)</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">slate</span><span class="o">::</span><span class="n">rank_k_update</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="n">slate</span><span class="o">::</span><span class="n">syrk</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
</pre></div>
</div>
<p>Computes <span class="math notranslate nohighlight">\(C = \alpha A A^T + \beta C\)</span> where <cite>C</cite> is symmetric. Only the designated triangle of <cite>C</cite> (Lower or Upper) is updated.</p>
<p><strong>Triangular Operations (TRMM/TRSM) (Lines 299-310)</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// B = alpha A B</span>
<span class="n">slate</span><span class="o">::</span><span class="n">triangular_multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span><span class="w">       </span><span class="c1">// trmm</span>

<span class="c1">// B = alpha A^{-1} B (Solve AX = B)</span>
<span class="n">slate</span><span class="o">::</span><span class="n">triangular_solve</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span><span class="w">          </span><span class="c1">// trsm</span>
</pre></div>
</div>
<p>For triangular matrices, we can multiply (<cite>trmm</cite>) or solve (<cite>trsm</cite>). The simplified API names make the intent clear (“multiply” vs “solve”).</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1">// ex05_blas.cc</span>
<span class="linenos">  2</span><span class="c1">// BLAS routines</span>
<span class="linenos">  3</span>
<span class="linenos">  4</span><span class="c1">/// !!!   Lines between `//---------- begin label`          !!!</span>
<span class="linenos">  5</span><span class="c1">/// !!!             and `//---------- end label`            !!!</span>
<span class="linenos">  6</span><span class="c1">/// !!!   are included in the SLATE Users&#39; Guide.           !!!</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;slate/slate.hh&gt;</span>
<span class="linenos">  9</span>
<span class="linenos"> 10</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;util.hh&quot;</span>
<span class="linenos"> 11</span>
<span class="linenos"> 12</span><span class="kt">int</span><span class="w"> </span><span class="n">mpi_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 13</span><span class="kt">int</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 14</span><span class="kt">int</span><span class="w"> </span><span class="n">grid_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 15</span><span class="kt">int</span><span class="w"> </span><span class="n">grid_q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos"> 18</span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">scalar_type</span><span class="o">&gt;</span>
<span class="linenos"> 19</span><span class="kt">void</span><span class="w"> </span><span class="n">test_gemm</span><span class="p">()</span>
<span class="linenos"> 20</span><span class="p">{</span>
<span class="linenos"> 21</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 22</span>
<span class="linenos"> 23</span><span class="w">    </span><span class="n">scalar_type</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos"> 24</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos"> 25</span>
<span class="linenos"> 26</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 27</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 28</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 29</span><span class="w">    </span><span class="n">A</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos"> 30</span><span class="w">    </span><span class="n">B</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos"> 31</span><span class="w">    </span><span class="n">C</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos"> 32</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 33</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 34</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 35</span>
<span class="linenos"> 36</span><span class="w">    </span><span class="c1">//---------- begin gemm</span>
<span class="linenos"> 37</span><span class="w">    </span><span class="c1">// C = alpha A B + beta C, where A, B, C are all general matrices.</span>
<span class="linenos"> 38</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// simplified API</span>
<span class="linenos"> 39</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">gemm</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">      </span><span class="c1">// traditional API</span>
<span class="linenos"> 40</span><span class="w">    </span><span class="c1">//---------- end gemm</span>
<span class="linenos"> 41</span>
<span class="linenos"> 42</span><span class="w">    </span><span class="c1">//--------------------</span>
<span class="linenos"> 43</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">blas</span><span class="o">::</span><span class="n">get_device_count</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 44</span><span class="w">        </span><span class="c1">//---------- begin gemm_opts</span>
<span class="linenos"> 45</span><span class="w">        </span><span class="c1">// Execute on GPU devices with lookahead of 2.</span>
<span class="linenos"> 46</span><span class="w">        </span><span class="n">slate</span><span class="o">::</span><span class="n">Options</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 47</span><span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Option</span><span class="o">::</span><span class="n">Lookahead</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">},</span>
<span class="linenos"> 48</span><span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Option</span><span class="o">::</span><span class="n">Target</span><span class="p">,</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Target</span><span class="o">::</span><span class="n">Devices</span><span class="w"> </span><span class="p">},</span>
<span class="linenos"> 49</span><span class="w">        </span><span class="p">};</span>
<span class="linenos"> 50</span><span class="w">        </span><span class="n">slate</span><span class="o">::</span><span class="n">multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 51</span><span class="w">        </span><span class="c1">//---------- end gemm_opts</span>
<span class="linenos"> 52</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 53</span><span class="p">}</span>
<span class="linenos"> 54</span>
<span class="linenos"> 55</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos"> 56</span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">scalar_type</span><span class="o">&gt;</span>
<span class="linenos"> 57</span><span class="kt">void</span><span class="w"> </span><span class="n">test_gemm_trans</span><span class="p">()</span>
<span class="linenos"> 58</span><span class="p">{</span>
<span class="linenos"> 59</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 60</span>
<span class="linenos"> 61</span><span class="w">    </span><span class="n">scalar_type</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos"> 62</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos"> 63</span>
<span class="linenos"> 64</span><span class="w">    </span><span class="c1">// Dimensions of A, B are backwards from A, B in test_gemm().</span>
<span class="linenos"> 65</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 66</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 67</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 68</span><span class="w">    </span><span class="n">A</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos"> 69</span><span class="w">    </span><span class="n">B</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos"> 70</span><span class="w">    </span><span class="n">C</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos"> 71</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 72</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 73</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 74</span>
<span class="linenos"> 75</span><span class="w">    </span><span class="c1">//---------- begin gemm_trans</span>
<span class="linenos"> 76</span>
<span class="linenos"> 77</span><span class="w">    </span><span class="c1">// Matrices can be transposed or conjugate-transposed beforehand.</span>
<span class="linenos"> 78</span><span class="w">    </span><span class="c1">// C = alpha A^T B^H + beta C</span>
<span class="linenos"> 79</span><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">AT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transpose</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 80</span><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">BH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conj_transpose</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 81</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">AT</span><span class="p">,</span><span class="w"> </span><span class="n">BH</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// simplified API</span>
<span class="linenos"> 82</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">gemm</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">AT</span><span class="p">,</span><span class="w"> </span><span class="n">BH</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">      </span><span class="c1">// traditional API</span>
<span class="linenos"> 83</span><span class="w">    </span><span class="c1">//---------- end gemm_trans</span>
<span class="linenos"> 84</span>
<span class="linenos"> 85</span><span class="w">    </span><span class="c1">// todo: support rvalues:</span>
<span class="linenos"> 86</span><span class="w">    </span><span class="c1">// slate::gemm( alpha, transpose( A ), conj_transpose( B ), beta, C );</span>
<span class="linenos"> 87</span><span class="w">    </span><span class="c1">// or</span>
<span class="linenos"> 88</span><span class="w">    </span><span class="c1">// slate::gemm( alpha, transpose( A ), conj_transpose( B ), beta, std::move( C ) );</span>
<span class="linenos"> 89</span><span class="p">}</span>
<span class="linenos"> 90</span>
<span class="linenos"> 91</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos"> 92</span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">scalar_type</span><span class="o">&gt;</span>
<span class="linenos"> 93</span><span class="kt">void</span><span class="w"> </span><span class="n">test_symm_left</span><span class="p">()</span>
<span class="linenos"> 94</span><span class="p">{</span>
<span class="linenos"> 95</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 96</span>
<span class="linenos"> 97</span><span class="w">    </span><span class="n">scalar_type</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos"> 98</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos"> 99</span>
<span class="linenos">100</span><span class="w">    </span><span class="c1">// A is m-by-m, B and C are m-by-n.</span>
<span class="linenos">101</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">SymmetricMatrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">102</span><span class="w">        </span><span class="n">A</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Uplo</span><span class="o">::</span><span class="n">Lower</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">103</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">104</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">105</span><span class="w">    </span><span class="n">A</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">106</span><span class="w">    </span><span class="n">B</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">107</span><span class="w">    </span><span class="n">C</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">108</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">109</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">110</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">111</span>
<span class="linenos">112</span><span class="w">    </span><span class="c1">//---------- begin symm_left</span>
<span class="linenos">113</span>
<span class="linenos">114</span><span class="w">    </span><span class="c1">// C = alpha A B + beta C, where A is symmetric, on left side</span>
<span class="linenos">115</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">                  </span><span class="c1">// simplified API</span>
<span class="linenos">116</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">symm</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Side</span><span class="o">::</span><span class="n">Left</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">   </span><span class="c1">// traditional API</span>
<span class="linenos">117</span><span class="w">    </span><span class="c1">//---------- end symm_left</span>
<span class="linenos">118</span><span class="p">}</span>
<span class="linenos">119</span>
<span class="linenos">120</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">121</span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">122</span><span class="kt">void</span><span class="w"> </span><span class="n">test_symm_right</span><span class="p">()</span>
<span class="linenos">123</span><span class="p">{</span>
<span class="linenos">124</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">125</span>
<span class="linenos">126</span><span class="w">    </span><span class="n">scalar_type</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos">127</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">128</span>
<span class="linenos">129</span><span class="w">    </span><span class="c1">// A is m-by-m, B and C are n-by-m (reverse of left case above).</span>
<span class="linenos">130</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">SymmetricMatrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">131</span><span class="w">        </span><span class="n">A</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Uplo</span><span class="o">::</span><span class="n">Lower</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">132</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">133</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">134</span><span class="w">    </span><span class="n">A</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">135</span><span class="w">    </span><span class="n">B</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">136</span><span class="w">    </span><span class="n">C</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">137</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">138</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">139</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">140</span>
<span class="linenos">141</span><span class="w">    </span><span class="c1">//---------- begin symm_right</span>
<span class="linenos">142</span>
<span class="linenos">143</span><span class="w">    </span><span class="c1">// C = alpha B A + beta C, where A is symmetric, on right side</span>
<span class="linenos">144</span><span class="w">    </span><span class="c1">// Note B, A order reversed in multiply compared to symm.</span>
<span class="linenos">145</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">                  </span><span class="c1">// simplified API</span>
<span class="linenos">146</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">symm</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Side</span><span class="o">::</span><span class="n">Right</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// traditional API</span>
<span class="linenos">147</span><span class="w">    </span><span class="c1">//---------- end symm_right</span>
<span class="linenos">148</span><span class="p">}</span>
<span class="linenos">149</span>
<span class="linenos">150</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">151</span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">152</span><span class="kt">void</span><span class="w"> </span><span class="n">test_hemm_left</span><span class="p">()</span>
<span class="linenos">153</span><span class="p">{</span>
<span class="linenos">154</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">155</span>
<span class="linenos">156</span><span class="w">    </span><span class="n">scalar_type</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos">157</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">158</span>
<span class="linenos">159</span><span class="w">    </span><span class="c1">// A is m-by-m, B and C are m-by-n.</span>
<span class="linenos">160</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">HermitianMatrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">161</span><span class="w">        </span><span class="n">A</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Uplo</span><span class="o">::</span><span class="n">Lower</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">162</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">163</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">164</span><span class="w">    </span><span class="n">A</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">165</span><span class="w">    </span><span class="n">B</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">166</span><span class="w">    </span><span class="n">C</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">167</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">168</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">169</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">170</span>
<span class="linenos">171</span><span class="w">    </span><span class="c1">//---------- begin hemm_left</span>
<span class="linenos">172</span>
<span class="linenos">173</span><span class="w">    </span><span class="c1">// C = alpha A B + beta C, where A is Hermitian, on left side</span>
<span class="linenos">174</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">                  </span><span class="c1">// simplified API</span>
<span class="linenos">175</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">hemm</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Side</span><span class="o">::</span><span class="n">Left</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">   </span><span class="c1">// traditional API</span>
<span class="linenos">176</span><span class="w">    </span><span class="c1">//---------- end hemm_left</span>
<span class="linenos">177</span><span class="p">}</span>
<span class="linenos">178</span>
<span class="linenos">179</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">180</span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">181</span><span class="kt">void</span><span class="w"> </span><span class="n">test_hemm_right</span><span class="p">()</span>
<span class="linenos">182</span><span class="p">{</span>
<span class="linenos">183</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">184</span>
<span class="linenos">185</span><span class="w">    </span><span class="n">scalar_type</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos">186</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">187</span>
<span class="linenos">188</span><span class="w">    </span><span class="c1">// A is m-by-m, B and C are n-by-m (reverse of left case above).</span>
<span class="linenos">189</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">HermitianMatrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">190</span><span class="w">        </span><span class="n">A</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Uplo</span><span class="o">::</span><span class="n">Lower</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">191</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">192</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">193</span><span class="w">    </span><span class="n">A</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">194</span><span class="w">    </span><span class="n">B</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">195</span><span class="w">    </span><span class="n">C</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">196</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">197</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">198</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">199</span>
<span class="linenos">200</span><span class="w">    </span><span class="c1">//---------- begin hemm_right</span>
<span class="linenos">201</span>
<span class="linenos">202</span><span class="w">    </span><span class="c1">// C = alpha B A + beta C, where A is Hermitian, on right side</span>
<span class="linenos">203</span><span class="w">    </span><span class="c1">// Note B, A order reversed in multiply compared to hemm.</span>
<span class="linenos">204</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">                  </span><span class="c1">// simplified API</span>
<span class="linenos">205</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">hemm</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Side</span><span class="o">::</span><span class="n">Right</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// traditional API</span>
<span class="linenos">206</span><span class="w">    </span><span class="c1">//---------- end hemm_right</span>
<span class="linenos">207</span><span class="p">}</span>
<span class="linenos">208</span>
<span class="linenos">209</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">210</span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">211</span><span class="kt">void</span><span class="w"> </span><span class="n">test_syrk_syr2k</span><span class="p">()</span>
<span class="linenos">212</span><span class="p">{</span>
<span class="linenos">213</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">214</span>
<span class="linenos">215</span><span class="w">    </span><span class="n">scalar_type</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos">216</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">217</span>
<span class="linenos">218</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">219</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">220</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">SymmetricMatrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">221</span><span class="w">        </span><span class="n">C</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Uplo</span><span class="o">::</span><span class="n">Lower</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">222</span><span class="w">    </span><span class="n">A</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">223</span><span class="w">    </span><span class="n">B</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">224</span><span class="w">    </span><span class="n">C</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">225</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">226</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">227</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">228</span>
<span class="linenos">229</span><span class="w">    </span><span class="c1">//---------- begin syrk</span>
<span class="linenos">230</span>
<span class="linenos">231</span><span class="w">    </span><span class="c1">// C = alpha A A^T + beta C, where C is symmetric</span>
<span class="linenos">232</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">rank_k_update</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">      </span><span class="c1">// simplified API</span>
<span class="linenos">233</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">syrk</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">               </span><span class="c1">// traditional API</span>
<span class="linenos">234</span><span class="w">    </span><span class="c1">//---------- end syrk</span>
<span class="linenos">235</span>
<span class="linenos">236</span><span class="w">    </span><span class="c1">//---------- begin syr2k</span>
<span class="linenos">237</span>
<span class="linenos">238</span><span class="w">    </span><span class="c1">// C = alpha A B^T + alpha B A^T + beta C, where C is symmetric</span>
<span class="linenos">239</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">rank_2k_update</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// simplified API</span>
<span class="linenos">240</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">syr2k</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">           </span><span class="c1">// traditional API</span>
<span class="linenos">241</span><span class="w">    </span><span class="c1">//---------- end syr2k</span>
<span class="linenos">242</span><span class="p">}</span>
<span class="linenos">243</span>
<span class="linenos">244</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">245</span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">246</span><span class="kt">void</span><span class="w"> </span><span class="n">test_herk_her2k</span><span class="p">()</span>
<span class="linenos">247</span><span class="p">{</span>
<span class="linenos">248</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">249</span>
<span class="linenos">250</span><span class="w">    </span><span class="n">scalar_type</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>
<span class="linenos">251</span><span class="w">    </span><span class="n">blas</span><span class="o">::</span><span class="n">real_type</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">alpha_real</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos">252</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">253</span>
<span class="linenos">254</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">255</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">256</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">HermitianMatrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">257</span><span class="w">        </span><span class="n">C</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Uplo</span><span class="o">::</span><span class="n">Lower</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">258</span><span class="w">    </span><span class="n">A</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">259</span><span class="w">    </span><span class="n">B</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">260</span><span class="w">    </span><span class="n">C</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">261</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">262</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">263</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">264</span>
<span class="linenos">265</span><span class="w">    </span><span class="c1">//---------- begin herk</span>
<span class="linenos">266</span>
<span class="linenos">267</span><span class="w">    </span><span class="c1">// C = alpha A A^H + beta C, where C is Hermitian</span>
<span class="linenos">268</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">rank_k_update</span><span class="p">(</span><span class="w"> </span><span class="n">alpha_real</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">      </span><span class="c1">// simplified API</span>
<span class="linenos">269</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">herk</span><span class="p">(</span><span class="w"> </span><span class="n">alpha_real</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">               </span><span class="c1">// traditional API</span>
<span class="linenos">270</span><span class="w">    </span><span class="c1">//---------- end herk</span>
<span class="linenos">271</span>
<span class="linenos">272</span><span class="w">    </span><span class="c1">//---------- begin her2k</span>
<span class="linenos">273</span>
<span class="linenos">274</span><span class="w">    </span><span class="c1">// C = alpha A B^H + conj(alpha) B A^H + beta C, where C is Hermitian</span>
<span class="linenos">275</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">rank_2k_update</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// simplified API</span>
<span class="linenos">276</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">her2k</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span><span class="w">           </span><span class="c1">// traditional API</span>
<span class="linenos">277</span><span class="w">    </span><span class="c1">//---------- end her2k</span>
<span class="linenos">278</span><span class="p">}</span>
<span class="linenos">279</span>
<span class="linenos">280</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">281</span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">282</span><span class="kt">void</span><span class="w"> </span><span class="n">test_trmm_trsm_left</span><span class="p">()</span>
<span class="linenos">283</span><span class="p">{</span>
<span class="linenos">284</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">285</span>
<span class="linenos">286</span><span class="w">    </span><span class="n">scalar_type</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>
<span class="linenos">287</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">288</span>
<span class="linenos">289</span><span class="w">    </span><span class="c1">// A is m-by-m, B is m-by-n</span>
<span class="linenos">290</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">TriangularMatrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">291</span><span class="w">        </span><span class="n">A</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Uplo</span><span class="o">::</span><span class="n">Lower</span><span class="p">,</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Diag</span><span class="o">::</span><span class="n">NonUnit</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span>
<span class="linenos">292</span><span class="w">           </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">293</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">294</span><span class="w">    </span><span class="n">A</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">295</span><span class="w">    </span><span class="n">B</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">296</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">297</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">298</span>
<span class="linenos">299</span><span class="w">    </span><span class="c1">//---------- begin trmm_left</span>
<span class="linenos">300</span>
<span class="linenos">301</span><span class="w">    </span><span class="c1">//----- left</span>
<span class="linenos">302</span><span class="w">    </span><span class="c1">// B = alpha A B, where A is triangular, on left side</span>
<span class="linenos">303</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">triangular_multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span><span class="w">       </span><span class="c1">// simplified API</span>
<span class="linenos">304</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">trmm</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Side</span><span class="o">::</span><span class="n">Left</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span><span class="w">   </span><span class="c1">// traditional API</span>
<span class="linenos">305</span>
<span class="linenos">306</span><span class="w">    </span><span class="c1">// Solve AX = B, where A is triangular, on left side; X overwrites B.</span>
<span class="linenos">307</span><span class="w">    </span><span class="c1">// That is, B = alpha A^{-1} B.</span>
<span class="linenos">308</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">triangular_solve</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span><span class="w">          </span><span class="c1">// simplified API</span>
<span class="linenos">309</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">trsm</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Side</span><span class="o">::</span><span class="n">Left</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span><span class="w">   </span><span class="c1">// traditional API</span>
<span class="linenos">310</span><span class="w">    </span><span class="c1">//---------- end trmm_left</span>
<span class="linenos">311</span><span class="p">}</span>
<span class="linenos">312</span>
<span class="linenos">313</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">314</span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">315</span><span class="kt">void</span><span class="w"> </span><span class="n">test_trmm_trsm_right</span><span class="p">()</span>
<span class="linenos">316</span><span class="p">{</span>
<span class="linenos">317</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">318</span>
<span class="linenos">319</span><span class="w">    </span><span class="n">scalar_type</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>
<span class="linenos">320</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">321</span>
<span class="linenos">322</span><span class="w">    </span><span class="c1">// A is m-by-m, B is n-by-m (reverse of left case above).</span>
<span class="linenos">323</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">TriangularMatrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">324</span><span class="w">        </span><span class="n">A</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Uplo</span><span class="o">::</span><span class="n">Lower</span><span class="p">,</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Diag</span><span class="o">::</span><span class="n">NonUnit</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span>
<span class="linenos">325</span><span class="w">           </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">326</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">327</span><span class="w">    </span><span class="n">A</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">328</span><span class="w">    </span><span class="n">B</span><span class="p">.</span><span class="n">insertLocalTiles</span><span class="p">();</span>
<span class="linenos">329</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">330</span><span class="w">    </span><span class="n">random_matrix</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">331</span>
<span class="linenos">332</span><span class="w">    </span><span class="c1">//---------- begin trmm_right</span>
<span class="linenos">333</span>
<span class="linenos">334</span><span class="w">    </span><span class="c1">//----- right</span>
<span class="linenos">335</span><span class="w">    </span><span class="c1">// B = alpha B A, where A is triangular, on right side</span>
<span class="linenos">336</span><span class="w">    </span><span class="c1">// Note B, A order reversed in multiply compared to trmm.</span>
<span class="linenos">337</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">triangular_multiply</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span><span class="w">       </span><span class="c1">// simplified API</span>
<span class="linenos">338</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">trmm</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Side</span><span class="o">::</span><span class="n">Right</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// traditional API</span>
<span class="linenos">339</span>
<span class="linenos">340</span><span class="w">    </span><span class="c1">// Solve XA = B, where A is triangular, on right side; X overwrites B.</span>
<span class="linenos">341</span><span class="w">    </span><span class="c1">// That is, B = alpha B A^{-1}.</span>
<span class="linenos">342</span><span class="w">    </span><span class="c1">// Note B, A order reversed in solve compared to trsm.</span>
<span class="linenos">343</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">triangular_solve</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span><span class="w">          </span><span class="c1">// simplified API</span>
<span class="linenos">344</span><span class="w">    </span><span class="n">slate</span><span class="o">::</span><span class="n">trsm</span><span class="p">(</span><span class="w"> </span><span class="n">slate</span><span class="o">::</span><span class="n">Side</span><span class="o">::</span><span class="n">Right</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// traditional API</span>
<span class="linenos">345</span><span class="w">    </span><span class="c1">//---------- end trmm_right</span>
<span class="linenos">346</span><span class="p">}</span>
<span class="linenos">347</span>
<span class="linenos">348</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">349</span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">scalar_type</span><span class="o">&gt;</span>
<span class="linenos">350</span><span class="kt">void</span><span class="w"> </span><span class="n">test_all</span><span class="p">()</span>
<span class="linenos">351</span><span class="p">{</span>
<span class="linenos">352</span><span class="w">    </span><span class="n">test_gemm</span><span class="w">      </span><span class="o">&lt;</span><span class="w"> </span><span class="n">scalar_type</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">353</span><span class="w">    </span><span class="n">test_gemm_trans</span><span class="o">&lt;</span><span class="w"> </span><span class="n">scalar_type</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">354</span><span class="w">    </span><span class="n">test_symm_left</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">scalar_type</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">355</span><span class="w">    </span><span class="n">test_symm_right</span><span class="o">&lt;</span><span class="w"> </span><span class="n">scalar_type</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">356</span><span class="w">    </span><span class="n">test_hemm_left</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">scalar_type</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">357</span><span class="w">    </span><span class="n">test_hemm_right</span><span class="o">&lt;</span><span class="w"> </span><span class="n">scalar_type</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">358</span><span class="w">    </span><span class="n">test_syrk_syr2k</span><span class="o">&lt;</span><span class="w"> </span><span class="n">scalar_type</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">359</span><span class="w">    </span><span class="n">test_herk_her2k</span><span class="o">&lt;</span><span class="w"> </span><span class="n">scalar_type</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">360</span><span class="w">    </span><span class="n">test_trmm_trsm_left</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">scalar_type</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">361</span><span class="w">    </span><span class="n">test_trmm_trsm_right</span><span class="o">&lt;</span><span class="w"> </span><span class="n">scalar_type</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">362</span><span class="p">}</span>
<span class="linenos">363</span>
<span class="linenos">364</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">365</span><span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">366</span><span class="p">{</span>
<span class="linenos">367</span><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">368</span><span class="w">        </span><span class="c1">// Parse command line to set types for s, d, c, z precisions.</span>
<span class="linenos">369</span><span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="n">types</span><span class="p">[</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">];</span>
<span class="linenos">370</span><span class="w">        </span><span class="n">parse_args</span><span class="p">(</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">371</span>
<span class="linenos">372</span><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">373</span><span class="w">        </span><span class="n">slate_mpi_call</span><span class="p">(</span>
<span class="linenos">374</span><span class="w">            </span><span class="n">MPI_Init_thread</span><span class="p">(</span><span class="w"> </span><span class="o">&amp;</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_THREAD_MULTIPLE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">provided</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">375</span><span class="w">        </span><span class="n">assert</span><span class="p">(</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPI_THREAD_MULTIPLE</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">376</span>
<span class="linenos">377</span><span class="w">        </span><span class="n">slate_mpi_call</span><span class="p">(</span>
<span class="linenos">378</span><span class="w">            </span><span class="n">MPI_Comm_size</span><span class="p">(</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mpi_size</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">379</span>
<span class="linenos">380</span><span class="w">        </span><span class="n">slate_mpi_call</span><span class="p">(</span>
<span class="linenos">381</span><span class="w">            </span><span class="n">MPI_Comm_rank</span><span class="p">(</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">382</span>
<span class="linenos">383</span><span class="w">        </span><span class="c1">// Determine p-by-q grid for this MPI size.</span>
<span class="linenos">384</span><span class="w">        </span><span class="n">grid_size</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_size</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">grid_q</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">385</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">386</span><span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;mpi_size %d, grid_p %d, grid_q %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="linenos">387</span><span class="w">                    </span><span class="n">mpi_size</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">388</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">389</span>
<span class="linenos">390</span><span class="w">        </span><span class="c1">// so random_matrix is different on different ranks.</span>
<span class="linenos">391</span><span class="w">        </span><span class="n">srand</span><span class="p">(</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">392</span>
<span class="linenos">393</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">[</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">394</span><span class="w">            </span><span class="n">test_all</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">395</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">396</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">397</span><span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">398</span>
<span class="linenos">399</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">[</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">400</span><span class="w">            </span><span class="n">test_all</span><span class="o">&lt;</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">401</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">402</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">403</span><span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">404</span>
<span class="linenos">405</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">[</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">406</span><span class="w">            </span><span class="n">test_all</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">407</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">408</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">409</span><span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">410</span>
<span class="linenos">411</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">[</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">412</span><span class="w">            </span><span class="n">test_all</span><span class="o">&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
<span class="linenos">413</span><span class="w">        </span><span class="p">}</span>
<span class="linenos">414</span>
<span class="linenos">415</span><span class="w">        </span><span class="n">slate_mpi_call</span><span class="p">(</span>
<span class="linenos">416</span><span class="w">            </span><span class="n">MPI_Finalize</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">417</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">418</span><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">419</span><span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="w"> </span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="n">what</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">420</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="linenos">421</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">422</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">423</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="c-api-example">
<h2>C API Example<a class="headerlink" href="#c-api-example" title="Link to this heading"></a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1">// ex05_blas.c</span>
<span class="linenos">  2</span><span class="c1">// BLAS routines</span>
<span class="linenos">  3</span>
<span class="linenos">  4</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;slate/c_api/slate.h&gt;</span>
<span class="linenos">  5</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;mpi.h&gt;</span>
<span class="linenos">  6</span>
<span class="linenos">  7</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;util.h&quot;</span>
<span class="linenos">  8</span>
<span class="linenos">  9</span><span class="kt">int</span><span class="w"> </span><span class="n">mpi_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 10</span><span class="kt">int</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 11</span><span class="kt">int</span><span class="w"> </span><span class="n">grid_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 12</span><span class="kt">int</span><span class="w"> </span><span class="n">grid_q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos"> 15</span><span class="kt">void</span><span class="w"> </span><span class="nf">test_gemm_r32</span><span class="p">()</span>
<span class="linenos"> 16</span><span class="p">{</span>
<span class="linenos"> 17</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 18</span>
<span class="linenos"> 19</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos"> 20</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos"> 21</span>
<span class="linenos"> 22</span><span class="w">    </span><span class="n">slate_Matrix_r32</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r32</span><span class="p">(</span>
<span class="linenos"> 23</span><span class="w">        </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 24</span><span class="w">    </span><span class="n">slate_Matrix_r32</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r32</span><span class="p">(</span>
<span class="linenos"> 25</span><span class="w">        </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 26</span><span class="w">    </span><span class="n">slate_Matrix_r32</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r32</span><span class="p">(</span>
<span class="linenos"> 27</span><span class="w">        </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 28</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 29</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 30</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 31</span><span class="w">    </span><span class="n">random_Matrix_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 32</span><span class="w">    </span><span class="n">random_Matrix_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 33</span><span class="w">    </span><span class="n">random_Matrix_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 34</span>
<span class="linenos"> 35</span><span class="w">    </span><span class="c1">// C = alpha A B + beta C, where A, B, C are all general matrices.</span>
<span class="linenos"> 36</span><span class="w">    </span><span class="n">slate_multiply_r32</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 37</span>
<span class="linenos"> 38</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">slate_Matrix_num_devices_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 39</span><span class="w">        </span><span class="c1">// Execute on GPU devices with lookahead of 2.</span>
<span class="linenos"> 40</span><span class="w">        </span><span class="n">slate_Options</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Options_create</span><span class="p">();</span>
<span class="linenos"> 41</span><span class="w">        </span><span class="n">slate_Options_set_Target</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="n">slate_Target_Devices</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 42</span><span class="w">        </span><span class="n">slate_Options_set_Lookahead</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 43</span>
<span class="linenos"> 44</span><span class="w">        </span><span class="n">slate_multiply_r32</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 45</span>
<span class="linenos"> 46</span><span class="w">        </span><span class="n">slate_Options_destroy</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 47</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 48</span>
<span class="linenos"> 49</span><span class="w">    </span><span class="n">slate_Matrix_destroy_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 50</span><span class="w">    </span><span class="n">slate_Matrix_destroy_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 51</span><span class="w">    </span><span class="n">slate_Matrix_destroy_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 52</span><span class="p">}</span>
<span class="linenos"> 53</span>
<span class="linenos"> 54</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos"> 55</span><span class="kt">void</span><span class="w"> </span><span class="nf">test_gemm_r64</span><span class="p">()</span>
<span class="linenos"> 56</span><span class="p">{</span>
<span class="linenos"> 57</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 58</span>
<span class="linenos"> 59</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos"> 60</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos"> 61</span>
<span class="linenos"> 62</span><span class="w">    </span><span class="n">slate_Matrix_r64</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r64</span><span class="p">(</span>
<span class="linenos"> 63</span><span class="w">        </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 64</span><span class="w">    </span><span class="n">slate_Matrix_r64</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r64</span><span class="p">(</span>
<span class="linenos"> 65</span><span class="w">        </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 66</span><span class="w">    </span><span class="n">slate_Matrix_r64</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r64</span><span class="p">(</span>
<span class="linenos"> 67</span><span class="w">        </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 68</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 69</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 70</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 71</span><span class="w">    </span><span class="n">random_Matrix_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 72</span><span class="w">    </span><span class="n">random_Matrix_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 73</span><span class="w">    </span><span class="n">random_Matrix_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 74</span>
<span class="linenos"> 75</span><span class="w">    </span><span class="c1">// C = alpha A B + beta C, where A, B, C are all general matrices.</span>
<span class="linenos"> 76</span><span class="w">    </span><span class="n">slate_multiply_r64</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 77</span>
<span class="linenos"> 78</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">slate_Matrix_num_devices_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 79</span><span class="w">        </span><span class="c1">// Execute on GPU devices with lookahead of 2.</span>
<span class="linenos"> 80</span><span class="w">        </span><span class="n">slate_Options</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Options_create</span><span class="p">();</span>
<span class="linenos"> 81</span><span class="w">        </span><span class="n">slate_Options_set_Target</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="n">slate_Target_Devices</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 82</span><span class="w">        </span><span class="n">slate_Options_set_Lookahead</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 83</span>
<span class="linenos"> 84</span><span class="w">        </span><span class="n">slate_multiply_r64</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 85</span>
<span class="linenos"> 86</span><span class="w">        </span><span class="n">slate_Options_destroy</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 87</span><span class="w">    </span><span class="p">}</span>
<span class="linenos"> 88</span>
<span class="linenos"> 89</span><span class="w">    </span><span class="n">slate_Matrix_destroy_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 90</span><span class="w">    </span><span class="n">slate_Matrix_destroy_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 91</span><span class="w">    </span><span class="n">slate_Matrix_destroy_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 92</span><span class="p">}</span>
<span class="linenos"> 93</span>
<span class="linenos"> 94</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos"> 95</span><span class="kt">void</span><span class="w"> </span><span class="nf">test_gemm_c32</span><span class="p">()</span>
<span class="linenos"> 96</span><span class="p">{</span>
<span class="linenos"> 97</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 98</span>
<span class="linenos"> 99</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos">100</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">101</span>
<span class="linenos">102</span><span class="w">    </span><span class="n">slate_Matrix_c32</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c32</span><span class="p">(</span>
<span class="linenos">103</span><span class="w">        </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">104</span><span class="w">    </span><span class="n">slate_Matrix_c32</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c32</span><span class="p">(</span>
<span class="linenos">105</span><span class="w">        </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">106</span><span class="w">    </span><span class="n">slate_Matrix_c32</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c32</span><span class="p">(</span>
<span class="linenos">107</span><span class="w">        </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">108</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">109</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">110</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">111</span><span class="w">    </span><span class="n">random_Matrix_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">112</span><span class="w">    </span><span class="n">random_Matrix_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">113</span><span class="w">    </span><span class="n">random_Matrix_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">114</span>
<span class="linenos">115</span><span class="w">    </span><span class="c1">// C = alpha A B + beta C, where A, B, C are all general matrices.</span>
<span class="linenos">116</span><span class="w">    </span><span class="n">slate_multiply_c32</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">117</span>
<span class="linenos">118</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">slate_Matrix_num_devices_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">119</span><span class="w">        </span><span class="c1">// Execute on GPU devices with lookahead of 2.</span>
<span class="linenos">120</span><span class="w">        </span><span class="n">slate_Options</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Options_create</span><span class="p">();</span>
<span class="linenos">121</span><span class="w">        </span><span class="n">slate_Options_set_Target</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="n">slate_Target_Devices</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">122</span><span class="w">        </span><span class="n">slate_Options_set_Lookahead</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">123</span>
<span class="linenos">124</span><span class="w">        </span><span class="n">slate_multiply_c32</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">125</span>
<span class="linenos">126</span><span class="w">        </span><span class="n">slate_Options_destroy</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">127</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">128</span>
<span class="linenos">129</span><span class="w">    </span><span class="n">slate_Matrix_destroy_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">130</span><span class="w">    </span><span class="n">slate_Matrix_destroy_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">131</span><span class="w">    </span><span class="n">slate_Matrix_destroy_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">132</span><span class="p">}</span>
<span class="linenos">133</span>
<span class="linenos">134</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">135</span><span class="kt">void</span><span class="w"> </span><span class="nf">test_gemm_c64</span><span class="p">()</span>
<span class="linenos">136</span><span class="p">{</span>
<span class="linenos">137</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">138</span>
<span class="linenos">139</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos">140</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">141</span>
<span class="linenos">142</span><span class="w">    </span><span class="n">slate_Matrix_c64</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c64</span><span class="p">(</span>
<span class="linenos">143</span><span class="w">        </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">144</span><span class="w">    </span><span class="n">slate_Matrix_c64</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c64</span><span class="p">(</span>
<span class="linenos">145</span><span class="w">        </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">146</span><span class="w">    </span><span class="n">slate_Matrix_c64</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c64</span><span class="p">(</span>
<span class="linenos">147</span><span class="w">        </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">148</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">149</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">150</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">151</span><span class="w">    </span><span class="n">random_Matrix_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">152</span><span class="w">    </span><span class="n">random_Matrix_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">153</span><span class="w">    </span><span class="n">random_Matrix_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">154</span>
<span class="linenos">155</span><span class="w">    </span><span class="c1">// C = alpha A B + beta C, where A, B, C are all general matrices.</span>
<span class="linenos">156</span><span class="w">    </span><span class="n">slate_multiply_c64</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">157</span>
<span class="linenos">158</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">slate_Matrix_num_devices_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">159</span><span class="w">        </span><span class="c1">// Execute on GPU devices with lookahead of 2.</span>
<span class="linenos">160</span><span class="w">        </span><span class="n">slate_Options</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Options_create</span><span class="p">();</span>
<span class="linenos">161</span><span class="w">        </span><span class="n">slate_Options_set_Target</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="n">slate_Target_Devices</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">162</span><span class="w">        </span><span class="n">slate_Options_set_Lookahead</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">163</span>
<span class="linenos">164</span><span class="w">        </span><span class="n">slate_multiply_c64</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">165</span>
<span class="linenos">166</span><span class="w">        </span><span class="n">slate_Options_destroy</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">167</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">168</span>
<span class="linenos">169</span><span class="w">    </span><span class="n">slate_Matrix_destroy_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">170</span><span class="w">    </span><span class="n">slate_Matrix_destroy_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">171</span><span class="w">    </span><span class="n">slate_Matrix_destroy_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">172</span><span class="p">}</span>
<span class="linenos">173</span>
<span class="linenos">174</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">175</span><span class="kt">void</span><span class="w"> </span><span class="nf">test_gemm_trans_r32</span><span class="p">()</span>
<span class="linenos">176</span><span class="p">{</span>
<span class="linenos">177</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">178</span>
<span class="linenos">179</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos">180</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">181</span>
<span class="linenos">182</span><span class="w">    </span><span class="n">slate_Matrix_r32</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r32</span><span class="p">(</span>
<span class="linenos">183</span><span class="w">        </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">184</span><span class="w">    </span><span class="n">slate_Matrix_r32</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r32</span><span class="p">(</span>
<span class="linenos">185</span><span class="w">        </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">186</span><span class="w">    </span><span class="n">slate_Matrix_r32</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r32</span><span class="p">(</span>
<span class="linenos">187</span><span class="w">        </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">188</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">189</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">190</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">191</span><span class="w">    </span><span class="n">random_Matrix_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">192</span><span class="w">    </span><span class="n">random_Matrix_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">193</span><span class="w">    </span><span class="n">random_Matrix_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">194</span>
<span class="linenos">195</span><span class="w">    </span><span class="c1">// Matrices can be transposed or conjugate-transposed beforehand.</span>
<span class="linenos">196</span><span class="w">    </span><span class="c1">// C = alpha A^T B^H + beta C</span>
<span class="linenos">197</span><span class="w">    </span><span class="n">slate_Matrix_transpose_in_place_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">198</span><span class="w">    </span><span class="n">slate_Matrix_conj_transpose_in_place_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">199</span><span class="w">    </span><span class="n">slate_multiply_r32</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// simplified API</span>
<span class="linenos">200</span>
<span class="linenos">201</span><span class="w">    </span><span class="n">slate_Matrix_destroy_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">202</span><span class="w">    </span><span class="n">slate_Matrix_destroy_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">203</span><span class="w">    </span><span class="n">slate_Matrix_destroy_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">204</span><span class="p">}</span>
<span class="linenos">205</span>
<span class="linenos">206</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">207</span><span class="kt">void</span><span class="w"> </span><span class="nf">test_gemm_trans_r64</span><span class="p">()</span>
<span class="linenos">208</span><span class="p">{</span>
<span class="linenos">209</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">210</span>
<span class="linenos">211</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos">212</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">213</span>
<span class="linenos">214</span><span class="w">    </span><span class="n">slate_Matrix_r64</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r64</span><span class="p">(</span>
<span class="linenos">215</span><span class="w">        </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">216</span><span class="w">    </span><span class="n">slate_Matrix_r64</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r64</span><span class="p">(</span>
<span class="linenos">217</span><span class="w">        </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">218</span><span class="w">    </span><span class="n">slate_Matrix_r64</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r64</span><span class="p">(</span>
<span class="linenos">219</span><span class="w">        </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">220</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">221</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">222</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">223</span><span class="w">    </span><span class="n">random_Matrix_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">224</span><span class="w">    </span><span class="n">random_Matrix_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">225</span><span class="w">    </span><span class="n">random_Matrix_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">226</span>
<span class="linenos">227</span><span class="w">    </span><span class="c1">// Matrices can be transposed or conjugate-transposed beforehand.</span>
<span class="linenos">228</span><span class="w">    </span><span class="c1">// C = alpha A^T B^H + beta C</span>
<span class="linenos">229</span><span class="w">    </span><span class="n">slate_Matrix_transpose_in_place_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">230</span><span class="w">    </span><span class="n">slate_Matrix_conj_transpose_in_place_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">231</span><span class="w">    </span><span class="n">slate_multiply_r64</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// simplified API</span>
<span class="linenos">232</span>
<span class="linenos">233</span><span class="w">    </span><span class="n">slate_Matrix_destroy_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">234</span><span class="w">    </span><span class="n">slate_Matrix_destroy_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">235</span><span class="w">    </span><span class="n">slate_Matrix_destroy_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">236</span><span class="p">}</span>
<span class="linenos">237</span>
<span class="linenos">238</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">239</span><span class="kt">void</span><span class="w"> </span><span class="nf">test_gemm_trans_c32</span><span class="p">()</span>
<span class="linenos">240</span><span class="p">{</span>
<span class="linenos">241</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">242</span>
<span class="linenos">243</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos">244</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">245</span>
<span class="linenos">246</span><span class="w">    </span><span class="n">slate_Matrix_c32</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c32</span><span class="p">(</span>
<span class="linenos">247</span><span class="w">        </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">248</span><span class="w">    </span><span class="n">slate_Matrix_c32</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c32</span><span class="p">(</span>
<span class="linenos">249</span><span class="w">        </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">250</span><span class="w">    </span><span class="n">slate_Matrix_c32</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c32</span><span class="p">(</span>
<span class="linenos">251</span><span class="w">        </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">252</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">253</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">254</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">255</span><span class="w">    </span><span class="n">random_Matrix_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">256</span><span class="w">    </span><span class="n">random_Matrix_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">257</span><span class="w">    </span><span class="n">random_Matrix_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">258</span>
<span class="linenos">259</span><span class="w">    </span><span class="c1">// Matrices can be transposed or conjugate-transposed beforehand.</span>
<span class="linenos">260</span><span class="w">    </span><span class="c1">// C = alpha A^T B^H + beta C</span>
<span class="linenos">261</span><span class="w">    </span><span class="n">slate_Matrix_transpose_in_place_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">262</span><span class="w">    </span><span class="n">slate_Matrix_conj_transpose_in_place_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">263</span><span class="w">    </span><span class="n">slate_multiply_c32</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// simplified API</span>
<span class="linenos">264</span>
<span class="linenos">265</span><span class="w">    </span><span class="n">slate_Matrix_destroy_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">266</span><span class="w">    </span><span class="n">slate_Matrix_destroy_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">267</span><span class="w">    </span><span class="n">slate_Matrix_destroy_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">268</span><span class="p">}</span>
<span class="linenos">269</span>
<span class="linenos">270</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">271</span><span class="kt">void</span><span class="w"> </span><span class="nf">test_gemm_trans_c64</span><span class="p">()</span>
<span class="linenos">272</span><span class="p">{</span>
<span class="linenos">273</span><span class="w">    </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">274</span>
<span class="linenos">275</span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="linenos">276</span><span class="w">    </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">m</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="o">=</span><span class="mi">256</span><span class="p">;</span>
<span class="linenos">277</span>
<span class="linenos">278</span><span class="w">    </span><span class="n">slate_Matrix_c64</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c64</span><span class="p">(</span>
<span class="linenos">279</span><span class="w">        </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">280</span><span class="w">    </span><span class="n">slate_Matrix_c64</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c64</span><span class="p">(</span>
<span class="linenos">281</span><span class="w">        </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">282</span><span class="w">    </span><span class="n">slate_Matrix_c64</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c64</span><span class="p">(</span>
<span class="linenos">283</span><span class="w">        </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w">    </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">284</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">285</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">286</span><span class="w">    </span><span class="n">slate_Matrix_insertLocalTiles_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">287</span><span class="w">    </span><span class="n">random_Matrix_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">288</span><span class="w">    </span><span class="n">random_Matrix_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">289</span><span class="w">    </span><span class="n">random_Matrix_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">290</span>
<span class="linenos">291</span><span class="w">    </span><span class="c1">// Matrices can be transposed or conjugate-transposed beforehand.</span>
<span class="linenos">292</span><span class="w">    </span><span class="c1">// C = alpha A^T B^H + beta C</span>
<span class="linenos">293</span><span class="w">    </span><span class="n">slate_Matrix_transpose_in_place_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">294</span><span class="w">    </span><span class="n">slate_Matrix_conj_transpose_in_place_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">295</span><span class="w">    </span><span class="n">slate_multiply_c64</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">);</span><span class="w">  </span><span class="c1">// simplified API</span>
<span class="linenos">296</span>
<span class="linenos">297</span><span class="w">    </span><span class="n">slate_Matrix_destroy_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">298</span><span class="w">    </span><span class="n">slate_Matrix_destroy_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">299</span><span class="w">    </span><span class="n">slate_Matrix_destroy_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">300</span><span class="p">}</span>
<span class="linenos">301</span>
<span class="linenos">302</span><span class="c1">//------------------------------------------------------------------------------</span>
<span class="linenos">303</span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">304</span><span class="p">{</span>
<span class="linenos">305</span><span class="w">    </span><span class="c1">// Parse command line to set types for s, d, c, z precisions.</span>
<span class="linenos">306</span><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">types</span><span class="p">[</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">];</span>
<span class="linenos">307</span><span class="w">    </span><span class="n">parse_args</span><span class="p">(</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">308</span>
<span class="linenos">309</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">310</span><span class="w">    </span><span class="n">MPI_Init_thread</span><span class="p">(</span><span class="w"> </span><span class="o">&amp;</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_THREAD_MULTIPLE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">provided</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">311</span><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPI_THREAD_MULTIPLE</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">312</span>
<span class="linenos">313</span><span class="w">    </span><span class="n">MPI_Comm_size</span><span class="p">(</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mpi_size</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">314</span><span class="w">    </span><span class="n">MPI_Comm_rank</span><span class="p">(</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">315</span>
<span class="linenos">316</span><span class="w">    </span><span class="c1">// Determine p-by-q grid for this MPI size.</span>
<span class="linenos">317</span><span class="w">    </span><span class="n">grid_size</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_size</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">grid_q</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">318</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">319</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;mpi_size %d, grid_p %d, grid_q %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="linenos">320</span><span class="w">                </span><span class="n">mpi_size</span><span class="p">,</span><span class="w"> </span><span class="n">grid_p</span><span class="p">,</span><span class="w"> </span><span class="n">grid_q</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">321</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">322</span>
<span class="linenos">323</span><span class="w">    </span><span class="c1">// so random_matrix is different on different ranks.</span>
<span class="linenos">324</span><span class="w">    </span><span class="n">srand</span><span class="p">(</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">325</span>
<span class="linenos">326</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">[</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">327</span><span class="w">        </span><span class="n">test_gemm_r32</span><span class="p">();</span>
<span class="linenos">328</span><span class="w">        </span><span class="n">test_gemm_trans_r32</span><span class="p">();</span>
<span class="linenos">329</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">330</span><span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">331</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">332</span>
<span class="linenos">333</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">[</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">334</span><span class="w">        </span><span class="n">test_gemm_r64</span><span class="p">();</span>
<span class="linenos">335</span><span class="w">        </span><span class="n">test_gemm_trans_r64</span><span class="p">();</span>
<span class="linenos">336</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">337</span><span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">338</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">339</span>
<span class="linenos">340</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">[</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">341</span><span class="w">        </span><span class="n">test_gemm_c32</span><span class="p">();</span>
<span class="linenos">342</span><span class="w">        </span><span class="n">test_gemm_trans_c32</span><span class="p">();</span>
<span class="linenos">343</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">344</span><span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">345</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">346</span>
<span class="linenos">347</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">[</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">348</span><span class="w">        </span><span class="n">test_gemm_c64</span><span class="p">();</span>
<span class="linenos">349</span><span class="w">        </span><span class="n">test_gemm_trans_c64</span><span class="p">();</span>
<span class="linenos">350</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">351</span>
<span class="linenos">352</span><span class="w">    </span><span class="n">MPI_Finalize</span><span class="p">();</span>
<span class="linenos">353</span>
<span class="linenos">354</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="linenos">355</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="fortran-api-example">
<h2>Fortran API Example<a class="headerlink" href="#fortran-api-example" title="Link to this heading"></a></h2>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c">! ex05_blas.f90</span>
<span class="linenos">  2</span><span class="c">! BLAS routines</span>
<span class="linenos">  3</span><span class="k">program </span><span class="n">ex05_blas</span>
<span class="linenos">  4</span><span class="w">    </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iso_fortran_env</span>
<span class="linenos">  5</span><span class="w">    </span><span class="k">use </span><span class="n">slate</span>
<span class="linenos">  6</span><span class="w">    </span><span class="k">use </span><span class="n">mpi</span>
<span class="linenos">  7</span><span class="w">    </span><span class="k">use </span><span class="n">util</span>
<span class="linenos">  8</span><span class="w">    </span><span class="k">implicit none</span>
<span class="linenos">  9</span>
<span class="linenos"> 10</span><span class="w">    </span><span class="c">!! Variables</span>
<span class="linenos"> 11</span><span class="w">    </span><span class="kt">logical</span><span class="w">                            </span><span class="kd">::</span><span class="w"> </span><span class="n">types</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="linenos"> 12</span><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int</span><span class="p">)</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int</span><span class="p">)</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">provided</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span>
<span class="linenos"> 15</span><span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int</span><span class="p">)</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">mpi_rank</span><span class="p">,</span><span class="w"> </span><span class="n">mpi_size</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span><span class="w">    </span><span class="c">!! Get requested types</span>
<span class="linenos"> 18</span><span class="w">    </span><span class="k">call </span><span class="n">parse_args</span><span class="p">(</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="p">);</span>
<span class="linenos"> 19</span>
<span class="linenos"> 20</span><span class="w">    </span><span class="c">!! MPI</span>
<span class="linenos"> 21</span><span class="w">    </span><span class="k">call </span><span class="n">MPI_Init_thread</span><span class="p">(</span><span class="w"> </span><span class="n">MPI_THREAD_MULTIPLE</span><span class="p">,</span><span class="w"> </span><span class="n">provided</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="linenos"> 22</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">ierr</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">provided</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">MPI_THREAD_MULTIPLE</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 23</span><span class="k">        print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Error: MPI_Init_thread&quot;</span>
<span class="linenos"> 24</span><span class="w">        </span><span class="k">return</span>
<span class="linenos"> 25</span><span class="k">    end if</span>
<span class="linenos"> 26</span><span class="k">    call </span><span class="n">MPI_Comm_size</span><span class="p">(</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="n">mpi_size</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="linenos"> 27</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 28</span><span class="k">        print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Error: MPI_Comm_size&quot;</span>
<span class="linenos"> 29</span><span class="w">        </span><span class="k">return</span>
<span class="linenos"> 30</span><span class="k">    end if</span>
<span class="linenos"> 31</span><span class="k">    call </span><span class="n">MPI_Comm_rank</span><span class="p">(</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="n">mpi_rank</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="linenos"> 32</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 33</span><span class="k">        print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Error: MPI_Comm_rank&quot;</span>
<span class="linenos"> 34</span><span class="w">        </span><span class="k">return</span>
<span class="linenos"> 35</span><span class="k">    end if</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span><span class="k">    call </span><span class="n">grid_size</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_size</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="w"> </span><span class="p">)</span>
<span class="linenos"> 38</span>
<span class="linenos"> 39</span><span class="w">    </span><span class="k">call </span><span class="nb">srand</span><span class="p">(</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mpi_rank</span><span class="w"> </span><span class="p">)</span>
<span class="linenos"> 40</span>
<span class="linenos"> 41</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 42</span><span class="k">        call </span><span class="n">test_gemm_r32</span><span class="p">()</span>
<span class="linenos"> 43</span><span class="w">        </span><span class="k">call </span><span class="n">test_gemm_trans_r32</span><span class="p">()</span>
<span class="linenos"> 44</span>
<span class="linenos"> 45</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 46</span><span class="k">          print</span><span class="w"> </span><span class="o">*</span>
<span class="linenos"> 47</span><span class="w">         </span><span class="k">end if</span>
<span class="linenos"> 48</span><span class="k">    end if</span>
<span class="linenos"> 49</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 50</span><span class="k">        call </span><span class="n">test_gemm_r64</span><span class="p">()</span>
<span class="linenos"> 51</span><span class="w">        </span><span class="k">call </span><span class="n">test_gemm_trans_r64</span><span class="p">()</span>
<span class="linenos"> 52</span>
<span class="linenos"> 53</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 54</span><span class="k">          print</span><span class="w"> </span><span class="o">*</span>
<span class="linenos"> 55</span><span class="w">         </span><span class="k">end if</span>
<span class="linenos"> 56</span><span class="k">    end if</span>
<span class="linenos"> 57</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 58</span><span class="k">        call </span><span class="n">test_gemm_c32</span><span class="p">()</span>
<span class="linenos"> 59</span><span class="w">        </span><span class="k">call </span><span class="n">test_gemm_trans_c32</span><span class="p">()</span>
<span class="linenos"> 60</span>
<span class="linenos"> 61</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 62</span><span class="k">          print</span><span class="w"> </span><span class="o">*</span>
<span class="linenos"> 63</span><span class="w">         </span><span class="k">end if</span>
<span class="linenos"> 64</span><span class="k">    end if</span>
<span class="linenos"> 65</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">types</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 66</span><span class="k">        call </span><span class="n">test_gemm_c64</span><span class="p">()</span>
<span class="linenos"> 67</span><span class="w">        </span><span class="k">call </span><span class="n">test_gemm_trans_c64</span><span class="p">()</span>
<span class="linenos"> 68</span>
<span class="linenos"> 69</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpi_rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 70</span><span class="k">          print</span><span class="w"> </span><span class="o">*</span>
<span class="linenos"> 71</span><span class="w">         </span><span class="k">end if</span>
<span class="linenos"> 72</span><span class="k">    end if</span>
<span class="linenos"> 73</span>
<span class="linenos"> 74</span><span class="k">    call </span><span class="n">MPI_Finalize</span><span class="p">(</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="linenos"> 75</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 76</span><span class="k">        print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Error: MPI_Finalize&quot;</span>
<span class="linenos"> 77</span><span class="w">        </span><span class="k">return</span>
<span class="linenos"> 78</span><span class="k">    end if</span>
<span class="linenos"> 79</span>
<span class="linenos"> 80</span><span class="k">contains</span>
<span class="linenos"> 81</span>
<span class="linenos"> 82</span><span class="k">    subroutine </span><span class="n">test_gemm_r32</span><span class="p">()</span>
<span class="linenos"> 83</span><span class="w">        </span><span class="c">!! Constants</span>
<span class="linenos"> 84</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">2000</span>
<span class="linenos"> 85</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="linenos"> 86</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span>
<span class="linenos"> 87</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">256</span>
<span class="linenos"> 88</span>
<span class="linenos"> 89</span><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_float</span><span class="p">),</span><span class="w">      </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="linenos"> 90</span><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_float</span><span class="p">),</span><span class="w">      </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">beta</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="linenos"> 91</span>
<span class="linenos"> 92</span><span class="w">        </span><span class="c">!! Variables</span>
<span class="linenos"> 93</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="linenos"> 94</span><span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span><span class="w">                        </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span>
<span class="linenos"> 95</span>
<span class="linenos"> 96</span><span class="w">        </span><span class="c">!! Example</span>
<span class="linenos"> 97</span><span class="w">        </span><span class="k">call </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;test_gemm_r32&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="linenos"> 98</span>
<span class="linenos"> 99</span><span class="w">        </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r32</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">100</span><span class="w">        </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r32</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">101</span><span class="w">        </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r32</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">102</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">103</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">104</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">105</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">106</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">107</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">108</span>
<span class="linenos">109</span><span class="w">        </span><span class="c">! C = alpha A B + beta C</span>
<span class="linenos">110</span><span class="w">        </span><span class="k">call </span><span class="n">slate_multiply_r32</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">c_null_ptr</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">111</span>
<span class="linenos">112</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">slate_Matrix_num_devices_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">113</span><span class="k">            </span><span class="n">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Options_create</span><span class="p">()</span>
<span class="linenos">114</span><span class="w">            </span><span class="k">call </span><span class="n">slate_Options_set_Target</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="n">slate_Target_Devices</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">115</span><span class="w">            </span><span class="k">call </span><span class="n">slate_Options_set_Lookahead</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="mi">2_int64</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">116</span>
<span class="linenos">117</span><span class="w">            </span><span class="k">call </span><span class="n">slate_multiply_r32</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">118</span>
<span class="linenos">119</span><span class="w">            </span><span class="k">call </span><span class="n">slate_Options_destroy</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">120</span><span class="w">        </span><span class="k">endif</span>
<span class="linenos">121</span>
<span class="linenos">122</span>
<span class="linenos">123</span><span class="k">        call </span><span class="n">slate_Matrix_destroy_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">124</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">125</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">126</span>
<span class="linenos">127</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">test_gemm_r32</span>
<span class="linenos">128</span>
<span class="linenos">129</span><span class="w">    </span><span class="k">subroutine </span><span class="n">test_gemm_r64</span><span class="p">()</span>
<span class="linenos">130</span><span class="w">        </span><span class="c">!! Constants</span>
<span class="linenos">131</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">2000</span>
<span class="linenos">132</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="linenos">133</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span>
<span class="linenos">134</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">256</span>
<span class="linenos">135</span>
<span class="linenos">136</span><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_double</span><span class="p">),</span><span class="w">     </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="linenos">137</span><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_double</span><span class="p">),</span><span class="w">     </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">beta</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="linenos">138</span>
<span class="linenos">139</span><span class="w">        </span><span class="c">!! Variables</span>
<span class="linenos">140</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="linenos">141</span><span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span><span class="w">                        </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span>
<span class="linenos">142</span>
<span class="linenos">143</span><span class="w">        </span><span class="c">!! Example</span>
<span class="linenos">144</span><span class="w">        </span><span class="k">call </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;test_gemm_r64&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">145</span>
<span class="linenos">146</span><span class="w">        </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r64</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">147</span><span class="w">        </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r64</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">148</span><span class="w">        </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r64</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">149</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">150</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">151</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">152</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">153</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">154</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">155</span>
<span class="linenos">156</span><span class="w">        </span><span class="c">! C = alpha A B + beta C</span>
<span class="linenos">157</span><span class="w">        </span><span class="k">call </span><span class="n">slate_multiply_r64</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">c_null_ptr</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">158</span>
<span class="linenos">159</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">slate_Matrix_num_devices_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">160</span><span class="k">            </span><span class="n">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Options_create</span><span class="p">()</span>
<span class="linenos">161</span><span class="w">            </span><span class="k">call </span><span class="n">slate_Options_set_Target</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="n">slate_Target_Devices</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">162</span><span class="w">            </span><span class="k">call </span><span class="n">slate_Options_set_Lookahead</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="mi">2_int64</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">163</span>
<span class="linenos">164</span><span class="w">            </span><span class="k">call </span><span class="n">slate_multiply_r64</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">165</span>
<span class="linenos">166</span><span class="w">            </span><span class="k">call </span><span class="n">slate_Options_destroy</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">167</span><span class="w">        </span><span class="k">endif</span>
<span class="linenos">168</span>
<span class="linenos">169</span>
<span class="linenos">170</span><span class="k">        call </span><span class="n">slate_Matrix_destroy_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">171</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">172</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">173</span>
<span class="linenos">174</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">test_gemm_r64</span>
<span class="linenos">175</span>
<span class="linenos">176</span><span class="w">    </span><span class="k">subroutine </span><span class="n">test_gemm_c32</span><span class="p">()</span>
<span class="linenos">177</span><span class="w">        </span><span class="c">!! Constants</span>
<span class="linenos">178</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">2000</span>
<span class="linenos">179</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="linenos">180</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span>
<span class="linenos">181</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">256</span>
<span class="linenos">182</span>
<span class="linenos">183</span><span class="w">        </span><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_float</span><span class="p">),</span><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="linenos">184</span><span class="w">        </span><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_float</span><span class="p">),</span><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">beta</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="linenos">185</span>
<span class="linenos">186</span><span class="w">        </span><span class="c">!! Variables</span>
<span class="linenos">187</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="linenos">188</span><span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span><span class="w">                        </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span>
<span class="linenos">189</span>
<span class="linenos">190</span><span class="w">        </span><span class="c">!! Example</span>
<span class="linenos">191</span><span class="w">        </span><span class="k">call </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;test_gemm_c32&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">192</span>
<span class="linenos">193</span><span class="w">        </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c32</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">194</span><span class="w">        </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c32</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">195</span><span class="w">        </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c32</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">196</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">197</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">198</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">199</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">200</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">201</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">202</span>
<span class="linenos">203</span><span class="w">        </span><span class="c">! C = alpha A B + beta C</span>
<span class="linenos">204</span><span class="w">        </span><span class="k">call </span><span class="n">slate_multiply_c32</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">c_null_ptr</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">205</span>
<span class="linenos">206</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">slate_Matrix_num_devices_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">207</span><span class="k">            </span><span class="n">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Options_create</span><span class="p">()</span>
<span class="linenos">208</span><span class="w">            </span><span class="k">call </span><span class="n">slate_Options_set_Target</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="n">slate_Target_Devices</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">209</span><span class="w">            </span><span class="k">call </span><span class="n">slate_Options_set_Lookahead</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="mi">2_int64</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">210</span>
<span class="linenos">211</span><span class="w">            </span><span class="k">call </span><span class="n">slate_multiply_c32</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">212</span>
<span class="linenos">213</span><span class="w">            </span><span class="k">call </span><span class="n">slate_Options_destroy</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">214</span><span class="w">        </span><span class="k">endif</span>
<span class="linenos">215</span>
<span class="linenos">216</span>
<span class="linenos">217</span><span class="k">        call </span><span class="n">slate_Matrix_destroy_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">218</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">219</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">220</span>
<span class="linenos">221</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">test_gemm_c32</span>
<span class="linenos">222</span>
<span class="linenos">223</span><span class="w">    </span><span class="k">subroutine </span><span class="n">test_gemm_c64</span><span class="p">()</span>
<span class="linenos">224</span><span class="w">        </span><span class="c">!! Constants</span>
<span class="linenos">225</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">2000</span>
<span class="linenos">226</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="linenos">227</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span>
<span class="linenos">228</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">256</span>
<span class="linenos">229</span>
<span class="linenos">230</span><span class="w">        </span><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_double</span><span class="p">),</span><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="linenos">231</span><span class="w">        </span><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_double</span><span class="p">),</span><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">beta</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="linenos">232</span>
<span class="linenos">233</span><span class="w">        </span><span class="c">!! Variables</span>
<span class="linenos">234</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="linenos">235</span><span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span><span class="w">                        </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span>
<span class="linenos">236</span>
<span class="linenos">237</span><span class="w">        </span><span class="c">!! Example</span>
<span class="linenos">238</span><span class="w">        </span><span class="k">call </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;test_gemm_c64&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">239</span>
<span class="linenos">240</span><span class="w">        </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c64</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">241</span><span class="w">        </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c64</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">242</span><span class="w">        </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c64</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">243</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">244</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">245</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">246</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">247</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">248</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">249</span>
<span class="linenos">250</span><span class="w">        </span><span class="c">! C = alpha A B + beta C</span>
<span class="linenos">251</span><span class="w">        </span><span class="k">call </span><span class="n">slate_multiply_c64</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">c_null_ptr</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">252</span>
<span class="linenos">253</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">slate_Matrix_num_devices_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">254</span><span class="k">            </span><span class="n">opts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Options_create</span><span class="p">()</span>
<span class="linenos">255</span><span class="w">            </span><span class="k">call </span><span class="n">slate_Options_set_Target</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="n">slate_Target_Devices</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">256</span><span class="w">            </span><span class="k">call </span><span class="n">slate_Options_set_Lookahead</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="mi">2_int64</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">257</span>
<span class="linenos">258</span><span class="w">            </span><span class="k">call </span><span class="n">slate_multiply_c64</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">259</span>
<span class="linenos">260</span><span class="w">            </span><span class="k">call </span><span class="n">slate_Options_destroy</span><span class="p">(</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">261</span><span class="w">        </span><span class="k">endif</span>
<span class="linenos">262</span>
<span class="linenos">263</span>
<span class="linenos">264</span><span class="k">        call </span><span class="n">slate_Matrix_destroy_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">265</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">266</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">267</span>
<span class="linenos">268</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">test_gemm_c64</span>
<span class="linenos">269</span>
<span class="linenos">270</span><span class="w">    </span><span class="k">subroutine </span><span class="n">test_gemm_trans_r32</span><span class="p">()</span>
<span class="linenos">271</span><span class="w">        </span><span class="c">!! Constants</span>
<span class="linenos">272</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">2000</span>
<span class="linenos">273</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="linenos">274</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span>
<span class="linenos">275</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">256</span>
<span class="linenos">276</span>
<span class="linenos">277</span><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_float</span><span class="p">),</span><span class="w">      </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="linenos">278</span><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_float</span><span class="p">),</span><span class="w">      </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">beta</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="linenos">279</span>
<span class="linenos">280</span><span class="w">        </span><span class="c">!! Variables</span>
<span class="linenos">281</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="linenos">282</span><span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span><span class="w">                        </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span>
<span class="linenos">283</span>
<span class="linenos">284</span><span class="w">        </span><span class="c">!! Example</span>
<span class="linenos">285</span><span class="w">        </span><span class="k">call </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;test_gemm_trans_r32&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">286</span>
<span class="linenos">287</span><span class="w">        </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r32</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">288</span><span class="w">        </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r32</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">289</span><span class="w">        </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r32</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">290</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">291</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">292</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">293</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">294</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">295</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">296</span>
<span class="linenos">297</span><span class="w">        </span><span class="c">! Matrices can be transposed or conjugate-transposed beforehand</span>
<span class="linenos">298</span><span class="w">        </span><span class="c">! C = alpha AT BH + beta C</span>
<span class="linenos">299</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_transpose_in_place_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">300</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_conj_transpose_in_place_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">301</span><span class="w">        </span><span class="k">call </span><span class="n">slate_multiply_r32</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">c_null_ptr</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">302</span>
<span class="linenos">303</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_r32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">304</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_r32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">305</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_r32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">306</span>
<span class="linenos">307</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">test_gemm_trans_r32</span>
<span class="linenos">308</span>
<span class="linenos">309</span><span class="w">    </span><span class="k">subroutine </span><span class="n">test_gemm_trans_r64</span><span class="p">()</span>
<span class="linenos">310</span><span class="w">        </span><span class="c">!! Constants</span>
<span class="linenos">311</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">2000</span>
<span class="linenos">312</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="linenos">313</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span>
<span class="linenos">314</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">256</span>
<span class="linenos">315</span>
<span class="linenos">316</span><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_double</span><span class="p">),</span><span class="w">     </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="linenos">317</span><span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_double</span><span class="p">),</span><span class="w">     </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">beta</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="linenos">318</span>
<span class="linenos">319</span><span class="w">        </span><span class="c">!! Variables</span>
<span class="linenos">320</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="linenos">321</span><span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span><span class="w">                        </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span>
<span class="linenos">322</span>
<span class="linenos">323</span><span class="w">        </span><span class="c">!! Example</span>
<span class="linenos">324</span><span class="w">        </span><span class="k">call </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;test_gemm_trans_r64&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">325</span>
<span class="linenos">326</span><span class="w">        </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r64</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">327</span><span class="w">        </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r64</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">328</span><span class="w">        </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_r64</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">329</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">330</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">331</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">332</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">333</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">334</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">335</span>
<span class="linenos">336</span><span class="w">        </span><span class="c">! Matrices can be transposed or conjugate-transposed beforehand</span>
<span class="linenos">337</span><span class="w">        </span><span class="c">! C = alpha AT BH + beta C</span>
<span class="linenos">338</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_transpose_in_place_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">339</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_conj_transpose_in_place_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">340</span><span class="w">        </span><span class="k">call </span><span class="n">slate_multiply_r64</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">c_null_ptr</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">341</span>
<span class="linenos">342</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_r64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">343</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_r64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">344</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_r64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">345</span>
<span class="linenos">346</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">test_gemm_trans_r64</span>
<span class="linenos">347</span>
<span class="linenos">348</span><span class="w">    </span><span class="k">subroutine </span><span class="n">test_gemm_trans_c32</span><span class="p">()</span>
<span class="linenos">349</span><span class="w">        </span><span class="c">!! Constants</span>
<span class="linenos">350</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">2000</span>
<span class="linenos">351</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="linenos">352</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span>
<span class="linenos">353</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">256</span>
<span class="linenos">354</span>
<span class="linenos">355</span><span class="w">        </span><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_float</span><span class="p">),</span><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="linenos">356</span><span class="w">        </span><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_float</span><span class="p">),</span><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">beta</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="linenos">357</span>
<span class="linenos">358</span><span class="w">        </span><span class="c">!! Variables</span>
<span class="linenos">359</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="linenos">360</span><span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span><span class="w">                        </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span>
<span class="linenos">361</span>
<span class="linenos">362</span><span class="w">        </span><span class="c">!! Example</span>
<span class="linenos">363</span><span class="w">        </span><span class="k">call </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;test_gemm_trans_c32&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">364</span>
<span class="linenos">365</span><span class="w">        </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c32</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">366</span><span class="w">        </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c32</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">367</span><span class="w">        </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c32</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">368</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">369</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">370</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">371</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">372</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">373</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">374</span>
<span class="linenos">375</span><span class="w">        </span><span class="c">! Matrices can be transposed or conjugate-transposed beforehand</span>
<span class="linenos">376</span><span class="w">        </span><span class="c">! C = alpha AT BH + beta C</span>
<span class="linenos">377</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_transpose_in_place_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">378</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_conj_transpose_in_place_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">379</span><span class="w">        </span><span class="k">call </span><span class="n">slate_multiply_c32</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">c_null_ptr</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">380</span>
<span class="linenos">381</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_c32</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">382</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_c32</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">383</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_c32</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">384</span>
<span class="linenos">385</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">test_gemm_trans_c32</span>
<span class="linenos">386</span>
<span class="linenos">387</span><span class="w">    </span><span class="k">subroutine </span><span class="n">test_gemm_trans_c64</span><span class="p">()</span>
<span class="linenos">388</span><span class="w">        </span><span class="c">!! Constants</span>
<span class="linenos">389</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">2000</span>
<span class="linenos">390</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="linenos">391</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span>
<span class="linenos">392</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">256</span>
<span class="linenos">393</span>
<span class="linenos">394</span><span class="w">        </span><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_double</span><span class="p">),</span><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span>
<span class="linenos">395</span><span class="w">        </span><span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_double</span><span class="p">),</span><span class="w">  </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">beta</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span>
<span class="linenos">396</span>
<span class="linenos">397</span><span class="w">        </span><span class="c">!! Variables</span>
<span class="linenos">398</span><span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int64_t</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="linenos">399</span><span class="w">        </span><span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span><span class="w">                        </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span>
<span class="linenos">400</span>
<span class="linenos">401</span><span class="w">        </span><span class="c">!! Example</span>
<span class="linenos">402</span><span class="w">        </span><span class="k">call </span><span class="n">print_func</span><span class="p">(</span><span class="w"> </span><span class="n">mpi_rank</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;test_gemm_trans_c64&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">403</span>
<span class="linenos">404</span><span class="w">        </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c64</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">405</span><span class="w">        </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c64</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">406</span><span class="w">        </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slate_Matrix_create_c64</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">p_grid</span><span class="p">,</span><span class="w"> </span><span class="n">q_grid</span><span class="p">,</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">407</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">408</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">409</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_insertLocalTiles_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">410</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">411</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">412</span><span class="w">        </span><span class="k">call </span><span class="n">random_Matrix_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">413</span>
<span class="linenos">414</span><span class="w">        </span><span class="c">! Matrices can be transposed or conjugate-transposed beforehand</span>
<span class="linenos">415</span><span class="w">        </span><span class="c">! C = alpha AT BH + beta C</span>
<span class="linenos">416</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_transpose_in_place_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">417</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_conj_transpose_in_place_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">);</span>
<span class="linenos">418</span><span class="w">        </span><span class="k">call </span><span class="n">slate_multiply_c64</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="nb">c_null_ptr</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">419</span>
<span class="linenos">420</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_c64</span><span class="p">(</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">421</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_c64</span><span class="p">(</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">422</span><span class="w">        </span><span class="k">call </span><span class="n">slate_Matrix_destroy_c64</span><span class="p">(</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="p">)</span>
<span class="linenos">423</span>
<span class="linenos">424</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">test_gemm_trans_c64</span>
<span class="linenos">425</span>
<span class="linenos">426</span><span class="k">end program </span><span class="n">ex05_blas</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ex04_norm.html" class="btn btn-neutral float-left" title="Example 04: Matrix Norms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ex06_linear_system_lu.html" class="btn btn-neutral float-right" title="Example 06: Linear Systems (LU)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2025, Innovative Computing Laboratory, University of Tennessee.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>